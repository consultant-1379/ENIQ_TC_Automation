{
    "TC01": "DECLARE @currentDateTime DATE, @date DATETIME SET @currentDateTime = (getdate()) SET @date = CAST(DATEADD(DAY, -7, @currentDateTime) AS DATE) DECLARE @erbsName VARCHAR(100) = ERBS_NODE DECLARE @cellName VARCHAR(100) = CELL_NAME select cast(round(avg(DL_FAILEDSESSIONS_T1),0) as numeric(36,2)) as 'Avg_Failed_User_Session' from ( SELECT D1.DATE_ID AS DATE_ID, D1.HOUR_ID AS HOUR_ID, D1.ERBS AS ERBS, D1.EUtranCellFDD AS EUtranCellFDD,D1.SN AS SN, D1.noFailedDLSessionsT1 AS DL_FAILEDSESSIONS_T1, D1.noFailedDLSessionsT2 AS DL_FAILEDSESSIONS_T2, D1.noFailedDLSessionsT3 AS DL_FAILEDSESSIONS_T3, D1.noFailedDLSessionsT4 AS DL_FAILEDSESSIONS_T4, D1.noFailedDLSessionsT5 AS DL_FAILEDSESSIONS_T5, (D1.noDLSessions + D2.noShortDLSessions) AS TOTAL_DL_SAMPLES , D1.noFailedULSessionsT1 AS UL_FAILEDSESSIONS_T1, D1.noFailedULSessionsT2 AS UL_FAILEDSESSIONS_T2, D1.noFailedULSessionsT3 AS UL_FAILEDSESSIONS_T3, D1.noFailedULSessionsT4 AS UL_FAILEDSESSIONS_T4, D1.noFailedULSessionsT5 AS UL_FAILEDSESSIONS_T5, (D1.noULSessions + D2.noShortULSessions) AS TOTAL_UL_SAMPLES FROM ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellFDD AS EUtranCellFDD,SN AS SN, SUM(case when DCVECTOR_INDEX <= 4 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT1 , SUM(case when DCVECTOR_INDEX <= 5 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT2 , SUM(case when DCVECTOR_INDEX <= 6 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT3 , SUM(case when DCVECTOR_INDEX <= 8 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT4, SUM(case when DCVECTOR_INDEX <= 11 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT5 , SUM(pmUeThpDlMbbFiltered2Distr) as noDLSessions, SUM(case when DCVECTOR_INDEX <= 4 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT1, SUM(case when DCVECTOR_INDEX <= 6 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT2, SUM(case when DCVECTOR_INDEX <= 9 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT3, SUM(case when DCVECTOR_INDEX <= 11 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT4, SUM(case when DCVECTOR_INDEX <= 15 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT5, SUM(pmMacUeThpUlMbbLowVolDistr) as noULSessions FROM DC_E_ERBS_EUTRANCELLFDD_V_RAW DA WHERE DA.DATE_ID >=@date AND DA.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') AND DA.DCVECTOR_INDEX <=26 and ERBS =@erbsName and EUTRANCELLFDD =@cellName GROUP BY DA.DATE_ID, DA.HOUR_ID, DA.ERBS,DA.EUtranCellFDD,DA.SN ) AS D1, ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellFDD AS EUtranCellFDD,SN AS SN, SUM(pmUeExclThpDlShortDrb) as noShortDLSessions, SUM(pmUeExclThpUlRelativeLowVol+pmUeExclThpUlShortTimeLowVol) as noShortULSessions FROM DC_E_ERBS_EUTRANCELLFDD_RAW DB WHERE DB.DATE_ID >=@date AND DB.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') GROUP BY DB.DATE_ID, DB.HOUR_ID, DB.ERBS,DB.EUtranCellFDD,DB.SN ) AS D2 WHERE D1.EUtranCellFDD = D2.EUtranCellFDD AND D1.SN =D2.SN AND D1.DATE_ID = D2.DATE_ID AND D1.HOUR_ID = D2.HOUR_ID AND (TOTAL_DL_SAMPLES is not null OR TOTAL_UL_SAMPLES is not null)   UNION  SELECT D1.DATE_ID AS DATE_ID, D1.HOUR_ID AS HOUR_ID, D1.ERBS AS ERBS, D1.EUtranCellTDD AS EUtranCellTDD,D1.SN AS SN, D1.noFailedDLSessionsT1 AS DL_FAILEDSESSIONS_T1, D1.noFailedDLSessionsT2 AS DL_FAILEDSESSIONS_T2, D1.noFailedDLSessionsT3 AS DL_FAILEDSESSIONS_T3, D1.noFailedDLSessionsT4 AS DL_FAILEDSESSIONS_T4, D1.noFailedDLSessionsT5 AS DL_FAILEDSESSIONS_T5, (D1.noDLSessions + D2.noShortDLSessions) AS TOTAL_DL_SAMPLES , D1.noFailedULSessionsT1 AS UL_FAILEDSESSIONS_T1, D1.noFailedULSessionsT2 AS UL_FAILEDSESSIONS_T2, D1.noFailedULSessionsT3 AS UL_FAILEDSESSIONS_T3, D1.noFailedULSessionsT4 AS UL_FAILEDSESSIONS_T4, D1.noFailedULSessionsT5 AS UL_FAILEDSESSIONS_T5, (D1.noULSessions + D2.noShortULSessions) AS TOTAL_UL_SAMPLES FROM ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellTDD AS EUtranCellTDD,SN AS SN, SUM(case when DCVECTOR_INDEX <= 4 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT1 , SUM(case when DCVECTOR_INDEX <= 5 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT2 , SUM(case when DCVECTOR_INDEX <= 6 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT3 , SUM(case when DCVECTOR_INDEX <= 8 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT4, SUM(case when DCVECTOR_INDEX <= 11 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT5 , SUM(pmUeThpDlMbbFiltered2Distr) as noDLSessions, SUM(case when DCVECTOR_INDEX <= 4 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT1, SUM(case when DCVECTOR_INDEX <= 6 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT2, SUM(case when DCVECTOR_INDEX <= 9 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT3, SUM(case when DCVECTOR_INDEX <= 11 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT4, SUM(case when DCVECTOR_INDEX <= 15 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT5, SUM(pmMacUeThpUlMbbLowVolDistr) as noULSessions FROM DC_E_ERBS_EUTRANCELLTDD_V_RAW DA WHERE DA.DATE_ID >=@date AND DA.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') AND DA.DCVECTOR_INDEX <=26  and  ERBS = @erbsName and EUTRANCELLTDD = @cellName GROUP BY DA.DATE_ID, DA.HOUR_ID, DA.ERBS,DA.EUtranCellTDD,DA.SN ) AS D1, ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellTDD AS EUtranCellTDD,SN AS SN, SUM(pmUeExclThpDlShortDrb) as noShortDLSessions, SUM(pmUeExclThpUlRelativeLowVol+pmUeExclThpUlShortTimeLowVol) as noShortULSessions FROM DC_E_ERBS_EUTRANCELLTDD_RAW DB WHERE DB.DATE_ID >=@date AND DB.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') GROUP BY DB.DATE_ID, DB.HOUR_ID, DB.ERBS,DB.EUtranCellTDD,DB.SN ) AS D2 WHERE D1.EUtranCellTDD = D2.EUtranCellTDD AND D1.SN = D2.SN AND D1.DATE_ID = D2.DATE_ID AND D1.HOUR_ID = D2.HOUR_ID AND (TOTAL_DL_SAMPLES is not null OR TOTAL_UL_SAMPLES is not null) ) as FINAL",
 	"TC02": "DECLARE @currentDateTime DATE, @date DATETIME SET @currentDateTime = (getdate()) SET @date = CAST(DATEADD(DAY, -7, @currentDateTime) AS DATE) DECLARE @erbsName VARCHAR(100) = ERBS_NODE DECLARE @cellName VARCHAR(100) = CELL_NAME select cast(round(avg(DL_FAILEDSESSIONS_T2),0) as numeric(36,2)) as 'Avg_Failed_User_Session' from ( SELECT D1.DATE_ID AS DATE_ID, D1.HOUR_ID AS HOUR_ID, D1.ERBS AS ERBS, D1.EUtranCellFDD AS EUtranCellFDD,D1.SN AS SN, D1.noFailedDLSessionsT1 AS DL_FAILEDSESSIONS_T1, D1.noFailedDLSessionsT2 AS DL_FAILEDSESSIONS_T2, D1.noFailedDLSessionsT3 AS DL_FAILEDSESSIONS_T3, D1.noFailedDLSessionsT4 AS DL_FAILEDSESSIONS_T4, D1.noFailedDLSessionsT5 AS DL_FAILEDSESSIONS_T5, (D1.noDLSessions + D2.noShortDLSessions) AS TOTAL_DL_SAMPLES , D1.noFailedULSessionsT1 AS UL_FAILEDSESSIONS_T1, D1.noFailedULSessionsT2 AS UL_FAILEDSESSIONS_T2, D1.noFailedULSessionsT3 AS UL_FAILEDSESSIONS_T3, D1.noFailedULSessionsT4 AS UL_FAILEDSESSIONS_T4, D1.noFailedULSessionsT5 AS UL_FAILEDSESSIONS_T5, (D1.noULSessions + D2.noShortULSessions) AS TOTAL_UL_SAMPLES FROM ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellFDD AS EUtranCellFDD,SN AS SN, SUM(case when DCVECTOR_INDEX <= 4 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT1 , SUM(case when DCVECTOR_INDEX <= 5 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT2 , SUM(case when DCVECTOR_INDEX <= 6 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT3 , SUM(case when DCVECTOR_INDEX <= 8 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT4, SUM(case when DCVECTOR_INDEX <= 11 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT5 , SUM(pmUeThpDlMbbFiltered2Distr) as noDLSessions, SUM(case when DCVECTOR_INDEX <= 4 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT1, SUM(case when DCVECTOR_INDEX <= 6 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT2, SUM(case when DCVECTOR_INDEX <= 9 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT3, SUM(case when DCVECTOR_INDEX <= 11 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT4, SUM(case when DCVECTOR_INDEX <= 15 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT5, SUM(pmMacUeThpUlMbbLowVolDistr) as noULSessions FROM DC_E_ERBS_EUTRANCELLFDD_V_RAW DA WHERE DA.DATE_ID >=@date AND DA.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') AND DA.DCVECTOR_INDEX <=26 and ERBS =@erbsName and EUTRANCELLFDD =@cellName GROUP BY DA.DATE_ID, DA.HOUR_ID, DA.ERBS,DA.EUtranCellFDD,DA.SN ) AS D1, ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellFDD AS EUtranCellFDD,SN AS SN, SUM(pmUeExclThpDlShortDrb) as noShortDLSessions, SUM(pmUeExclThpUlRelativeLowVol+pmUeExclThpUlShortTimeLowVol) as noShortULSessions FROM DC_E_ERBS_EUTRANCELLFDD_RAW DB WHERE DB.DATE_ID >=@date AND DB.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') GROUP BY DB.DATE_ID, DB.HOUR_ID, DB.ERBS,DB.EUtranCellFDD,DB.SN ) AS D2 WHERE D1.EUtranCellFDD = D2.EUtranCellFDD AND D1.SN =D2.SN AND D1.DATE_ID = D2.DATE_ID AND D1.HOUR_ID = D2.HOUR_ID AND (TOTAL_DL_SAMPLES is not null OR TOTAL_UL_SAMPLES is not null)   UNION  SELECT D1.DATE_ID AS DATE_ID, D1.HOUR_ID AS HOUR_ID, D1.ERBS AS ERBS, D1.EUtranCellTDD AS EUtranCellTDD,D1.SN AS SN, D1.noFailedDLSessionsT1 AS DL_FAILEDSESSIONS_T1, D1.noFailedDLSessionsT2 AS DL_FAILEDSESSIONS_T2, D1.noFailedDLSessionsT3 AS DL_FAILEDSESSIONS_T3, D1.noFailedDLSessionsT4 AS DL_FAILEDSESSIONS_T4, D1.noFailedDLSessionsT5 AS DL_FAILEDSESSIONS_T5, (D1.noDLSessions + D2.noShortDLSessions) AS TOTAL_DL_SAMPLES , D1.noFailedULSessionsT1 AS UL_FAILEDSESSIONS_T1, D1.noFailedULSessionsT2 AS UL_FAILEDSESSIONS_T2, D1.noFailedULSessionsT3 AS UL_FAILEDSESSIONS_T3, D1.noFailedULSessionsT4 AS UL_FAILEDSESSIONS_T4, D1.noFailedULSessionsT5 AS UL_FAILEDSESSIONS_T5, (D1.noULSessions + D2.noShortULSessions) AS TOTAL_UL_SAMPLES FROM ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellTDD AS EUtranCellTDD,SN AS SN, SUM(case when DCVECTOR_INDEX <= 4 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT1 , SUM(case when DCVECTOR_INDEX <= 5 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT2 , SUM(case when DCVECTOR_INDEX <= 6 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT3 , SUM(case when DCVECTOR_INDEX <= 8 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT4, SUM(case when DCVECTOR_INDEX <= 11 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT5 , SUM(pmUeThpDlMbbFiltered2Distr) as noDLSessions, SUM(case when DCVECTOR_INDEX <= 4 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT1, SUM(case when DCVECTOR_INDEX <= 6 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT2, SUM(case when DCVECTOR_INDEX <= 9 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT3, SUM(case when DCVECTOR_INDEX <= 11 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT4, SUM(case when DCVECTOR_INDEX <= 15 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT5, SUM(pmMacUeThpUlMbbLowVolDistr) as noULSessions FROM DC_E_ERBS_EUTRANCELLTDD_V_RAW DA WHERE DA.DATE_ID >=@date AND DA.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') AND DA.DCVECTOR_INDEX <=26  and  ERBS = @erbsName and EUTRANCELLTDD = @cellName GROUP BY DA.DATE_ID, DA.HOUR_ID, DA.ERBS,DA.EUtranCellTDD,DA.SN ) AS D1, ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellTDD AS EUtranCellTDD,SN AS SN, SUM(pmUeExclThpDlShortDrb) as noShortDLSessions, SUM(pmUeExclThpUlRelativeLowVol+pmUeExclThpUlShortTimeLowVol) as noShortULSessions FROM DC_E_ERBS_EUTRANCELLTDD_RAW DB WHERE DB.DATE_ID >=@date AND DB.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') GROUP BY DB.DATE_ID, DB.HOUR_ID, DB.ERBS,DB.EUtranCellTDD,DB.SN ) AS D2 WHERE D1.EUtranCellTDD = D2.EUtranCellTDD AND D1.SN = D2.SN AND D1.DATE_ID = D2.DATE_ID AND D1.HOUR_ID = D2.HOUR_ID AND (TOTAL_DL_SAMPLES is not null OR TOTAL_UL_SAMPLES is not null) ) as FINAL",
	"TC03": "DECLARE @currentDateTime DATE, @date DATETIME SET @currentDateTime = (getdate()) SET @date = CAST(DATEADD(DAY, -7, @currentDateTime) AS DATE) DECLARE @erbsName VARCHAR(100) = ERBS_NODE DECLARE @cellName VARCHAR(100) = CELL_NAME select cast(round(avg(DL_FAILEDSESSIONS_T3),0) as numeric(36,2)) as 'Avg_Failed_User_Session' from ( SELECT D1.DATE_ID AS DATE_ID, D1.HOUR_ID AS HOUR_ID, D1.ERBS AS ERBS, D1.EUtranCellFDD AS EUtranCellFDD,D1.SN AS SN, D1.noFailedDLSessionsT1 AS DL_FAILEDSESSIONS_T1, D1.noFailedDLSessionsT2 AS DL_FAILEDSESSIONS_T2, D1.noFailedDLSessionsT3 AS DL_FAILEDSESSIONS_T3, D1.noFailedDLSessionsT4 AS DL_FAILEDSESSIONS_T4, D1.noFailedDLSessionsT5 AS DL_FAILEDSESSIONS_T5, (D1.noDLSessions + D2.noShortDLSessions) AS TOTAL_DL_SAMPLES , D1.noFailedULSessionsT1 AS UL_FAILEDSESSIONS_T1, D1.noFailedULSessionsT2 AS UL_FAILEDSESSIONS_T2, D1.noFailedULSessionsT3 AS UL_FAILEDSESSIONS_T3, D1.noFailedULSessionsT4 AS UL_FAILEDSESSIONS_T4, D1.noFailedULSessionsT5 AS UL_FAILEDSESSIONS_T5, (D1.noULSessions + D2.noShortULSessions) AS TOTAL_UL_SAMPLES FROM ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellFDD AS EUtranCellFDD,SN AS SN, SUM(case when DCVECTOR_INDEX <= 4 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT1 , SUM(case when DCVECTOR_INDEX <= 5 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT2 , SUM(case when DCVECTOR_INDEX <= 6 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT3 , SUM(case when DCVECTOR_INDEX <= 8 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT4, SUM(case when DCVECTOR_INDEX <= 11 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT5 , SUM(pmUeThpDlMbbFiltered2Distr) as noDLSessions, SUM(case when DCVECTOR_INDEX <= 4 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT1, SUM(case when DCVECTOR_INDEX <= 6 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT2, SUM(case when DCVECTOR_INDEX <= 9 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT3, SUM(case when DCVECTOR_INDEX <= 11 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT4, SUM(case when DCVECTOR_INDEX <= 15 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT5, SUM(pmMacUeThpUlMbbLowVolDistr) as noULSessions FROM DC_E_ERBS_EUTRANCELLFDD_V_RAW DA WHERE DA.DATE_ID >=@date AND DA.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') AND DA.DCVECTOR_INDEX <=26 and ERBS =@erbsName and EUTRANCELLFDD =@cellName GROUP BY DA.DATE_ID, DA.HOUR_ID, DA.ERBS,DA.EUtranCellFDD,DA.SN ) AS D1, ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellFDD AS EUtranCellFDD,SN AS SN, SUM(pmUeExclThpDlShortDrb) as noShortDLSessions, SUM(pmUeExclThpUlRelativeLowVol+pmUeExclThpUlShortTimeLowVol) as noShortULSessions FROM DC_E_ERBS_EUTRANCELLFDD_RAW DB WHERE DB.DATE_ID >=@date AND DB.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') GROUP BY DB.DATE_ID, DB.HOUR_ID, DB.ERBS,DB.EUtranCellFDD,DB.SN ) AS D2 WHERE D1.EUtranCellFDD = D2.EUtranCellFDD AND D1.SN =D2.SN AND D1.DATE_ID = D2.DATE_ID AND D1.HOUR_ID = D2.HOUR_ID AND (TOTAL_DL_SAMPLES is not null OR TOTAL_UL_SAMPLES is not null)   UNION  SELECT D1.DATE_ID AS DATE_ID, D1.HOUR_ID AS HOUR_ID, D1.ERBS AS ERBS, D1.EUtranCellTDD AS EUtranCellTDD,D1.SN AS SN, D1.noFailedDLSessionsT1 AS DL_FAILEDSESSIONS_T1, D1.noFailedDLSessionsT2 AS DL_FAILEDSESSIONS_T2, D1.noFailedDLSessionsT3 AS DL_FAILEDSESSIONS_T3, D1.noFailedDLSessionsT4 AS DL_FAILEDSESSIONS_T4, D1.noFailedDLSessionsT5 AS DL_FAILEDSESSIONS_T5, (D1.noDLSessions + D2.noShortDLSessions) AS TOTAL_DL_SAMPLES , D1.noFailedULSessionsT1 AS UL_FAILEDSESSIONS_T1, D1.noFailedULSessionsT2 AS UL_FAILEDSESSIONS_T2, D1.noFailedULSessionsT3 AS UL_FAILEDSESSIONS_T3, D1.noFailedULSessionsT4 AS UL_FAILEDSESSIONS_T4, D1.noFailedULSessionsT5 AS UL_FAILEDSESSIONS_T5, (D1.noULSessions + D2.noShortULSessions) AS TOTAL_UL_SAMPLES FROM ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellTDD AS EUtranCellTDD,SN AS SN, SUM(case when DCVECTOR_INDEX <= 4 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT1 , SUM(case when DCVECTOR_INDEX <= 5 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT2 , SUM(case when DCVECTOR_INDEX <= 6 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT3 , SUM(case when DCVECTOR_INDEX <= 8 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT4, SUM(case when DCVECTOR_INDEX <= 11 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT5 , SUM(pmUeThpDlMbbFiltered2Distr) as noDLSessions, SUM(case when DCVECTOR_INDEX <= 4 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT1, SUM(case when DCVECTOR_INDEX <= 6 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT2, SUM(case when DCVECTOR_INDEX <= 9 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT3, SUM(case when DCVECTOR_INDEX <= 11 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT4, SUM(case when DCVECTOR_INDEX <= 15 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT5, SUM(pmMacUeThpUlMbbLowVolDistr) as noULSessions FROM DC_E_ERBS_EUTRANCELLTDD_V_RAW DA WHERE DA.DATE_ID >=@date AND DA.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') AND DA.DCVECTOR_INDEX <=26  and  ERBS = @erbsName and EUTRANCELLTDD = @cellName GROUP BY DA.DATE_ID, DA.HOUR_ID, DA.ERBS,DA.EUtranCellTDD,DA.SN ) AS D1, ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellTDD AS EUtranCellTDD,SN AS SN, SUM(pmUeExclThpDlShortDrb) as noShortDLSessions, SUM(pmUeExclThpUlRelativeLowVol+pmUeExclThpUlShortTimeLowVol) as noShortULSessions FROM DC_E_ERBS_EUTRANCELLTDD_RAW DB WHERE DB.DATE_ID >=@date AND DB.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') GROUP BY DB.DATE_ID, DB.HOUR_ID, DB.ERBS,DB.EUtranCellTDD,DB.SN ) AS D2 WHERE D1.EUtranCellTDD = D2.EUtranCellTDD AND D1.SN = D2.SN AND D1.DATE_ID = D2.DATE_ID AND D1.HOUR_ID = D2.HOUR_ID AND (TOTAL_DL_SAMPLES is not null OR TOTAL_UL_SAMPLES is not null) ) as FINAL",
 	"TC04": "DECLARE @currentDateTime DATE, @date DATETIME SET @currentDateTime = (getdate()) SET @date = CAST(DATEADD(DAY, -7, @currentDateTime) AS DATE) DECLARE @erbsName VARCHAR(100) = ERBS_NODE DECLARE @cellName VARCHAR(100) = CELL_NAME select cast(round(avg(DL_FAILEDSESSIONS_T4),0) as numeric(36,2)) as 'Avg_Failed_User_Session' from ( SELECT D1.DATE_ID AS DATE_ID, D1.HOUR_ID AS HOUR_ID, D1.ERBS AS ERBS, D1.EUtranCellFDD AS EUtranCellFDD,D1.SN AS SN, D1.noFailedDLSessionsT1 AS DL_FAILEDSESSIONS_T1, D1.noFailedDLSessionsT2 AS DL_FAILEDSESSIONS_T2, D1.noFailedDLSessionsT3 AS DL_FAILEDSESSIONS_T3, D1.noFailedDLSessionsT4 AS DL_FAILEDSESSIONS_T4, D1.noFailedDLSessionsT5 AS DL_FAILEDSESSIONS_T5, (D1.noDLSessions + D2.noShortDLSessions) AS TOTAL_DL_SAMPLES , D1.noFailedULSessionsT1 AS UL_FAILEDSESSIONS_T1, D1.noFailedULSessionsT2 AS UL_FAILEDSESSIONS_T2, D1.noFailedULSessionsT3 AS UL_FAILEDSESSIONS_T3, D1.noFailedULSessionsT4 AS UL_FAILEDSESSIONS_T4, D1.noFailedULSessionsT5 AS UL_FAILEDSESSIONS_T5, (D1.noULSessions + D2.noShortULSessions) AS TOTAL_UL_SAMPLES FROM ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellFDD AS EUtranCellFDD,SN AS SN, SUM(case when DCVECTOR_INDEX <= 4 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT1 , SUM(case when DCVECTOR_INDEX <= 5 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT2 , SUM(case when DCVECTOR_INDEX <= 6 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT3 , SUM(case when DCVECTOR_INDEX <= 8 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT4, SUM(case when DCVECTOR_INDEX <= 11 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT5 , SUM(pmUeThpDlMbbFiltered2Distr) as noDLSessions, SUM(case when DCVECTOR_INDEX <= 4 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT1, SUM(case when DCVECTOR_INDEX <= 6 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT2, SUM(case when DCVECTOR_INDEX <= 9 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT3, SUM(case when DCVECTOR_INDEX <= 11 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT4, SUM(case when DCVECTOR_INDEX <= 15 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT5, SUM(pmMacUeThpUlMbbLowVolDistr) as noULSessions FROM DC_E_ERBS_EUTRANCELLFDD_V_RAW DA WHERE DA.DATE_ID >=@date AND DA.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') AND DA.DCVECTOR_INDEX <=26 and ERBS =@erbsName and EUTRANCELLFDD =@cellName GROUP BY DA.DATE_ID, DA.HOUR_ID, DA.ERBS,DA.EUtranCellFDD,DA.SN ) AS D1, ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellFDD AS EUtranCellFDD,SN AS SN, SUM(pmUeExclThpDlShortDrb) as noShortDLSessions, SUM(pmUeExclThpUlRelativeLowVol+pmUeExclThpUlShortTimeLowVol) as noShortULSessions FROM DC_E_ERBS_EUTRANCELLFDD_RAW DB WHERE DB.DATE_ID >=@date AND DB.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') GROUP BY DB.DATE_ID, DB.HOUR_ID, DB.ERBS,DB.EUtranCellFDD,DB.SN ) AS D2 WHERE D1.EUtranCellFDD = D2.EUtranCellFDD AND D1.SN =D2.SN AND D1.DATE_ID = D2.DATE_ID AND D1.HOUR_ID = D2.HOUR_ID AND (TOTAL_DL_SAMPLES is not null OR TOTAL_UL_SAMPLES is not null)   UNION  SELECT D1.DATE_ID AS DATE_ID, D1.HOUR_ID AS HOUR_ID, D1.ERBS AS ERBS, D1.EUtranCellTDD AS EUtranCellTDD,D1.SN AS SN, D1.noFailedDLSessionsT1 AS DL_FAILEDSESSIONS_T1, D1.noFailedDLSessionsT2 AS DL_FAILEDSESSIONS_T2, D1.noFailedDLSessionsT3 AS DL_FAILEDSESSIONS_T3, D1.noFailedDLSessionsT4 AS DL_FAILEDSESSIONS_T4, D1.noFailedDLSessionsT5 AS DL_FAILEDSESSIONS_T5, (D1.noDLSessions + D2.noShortDLSessions) AS TOTAL_DL_SAMPLES , D1.noFailedULSessionsT1 AS UL_FAILEDSESSIONS_T1, D1.noFailedULSessionsT2 AS UL_FAILEDSESSIONS_T2, D1.noFailedULSessionsT3 AS UL_FAILEDSESSIONS_T3, D1.noFailedULSessionsT4 AS UL_FAILEDSESSIONS_T4, D1.noFailedULSessionsT5 AS UL_FAILEDSESSIONS_T5, (D1.noULSessions + D2.noShortULSessions) AS TOTAL_UL_SAMPLES FROM ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellTDD AS EUtranCellTDD,SN AS SN, SUM(case when DCVECTOR_INDEX <= 4 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT1 , SUM(case when DCVECTOR_INDEX <= 5 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT2 , SUM(case when DCVECTOR_INDEX <= 6 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT3 , SUM(case when DCVECTOR_INDEX <= 8 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT4, SUM(case when DCVECTOR_INDEX <= 11 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT5 , SUM(pmUeThpDlMbbFiltered2Distr) as noDLSessions, SUM(case when DCVECTOR_INDEX <= 4 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT1, SUM(case when DCVECTOR_INDEX <= 6 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT2, SUM(case when DCVECTOR_INDEX <= 9 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT3, SUM(case when DCVECTOR_INDEX <= 11 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT4, SUM(case when DCVECTOR_INDEX <= 15 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT5, SUM(pmMacUeThpUlMbbLowVolDistr) as noULSessions FROM DC_E_ERBS_EUTRANCELLTDD_V_RAW DA WHERE DA.DATE_ID >=@date AND DA.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') AND DA.DCVECTOR_INDEX <=26  and  ERBS = @erbsName and EUTRANCELLTDD = @cellName GROUP BY DA.DATE_ID, DA.HOUR_ID, DA.ERBS,DA.EUtranCellTDD,DA.SN ) AS D1, ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellTDD AS EUtranCellTDD,SN AS SN, SUM(pmUeExclThpDlShortDrb) as noShortDLSessions, SUM(pmUeExclThpUlRelativeLowVol+pmUeExclThpUlShortTimeLowVol) as noShortULSessions FROM DC_E_ERBS_EUTRANCELLTDD_RAW DB WHERE DB.DATE_ID >=@date AND DB.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') GROUP BY DB.DATE_ID, DB.HOUR_ID, DB.ERBS,DB.EUtranCellTDD,DB.SN ) AS D2 WHERE D1.EUtranCellTDD = D2.EUtranCellTDD AND D1.SN = D2.SN AND D1.DATE_ID = D2.DATE_ID AND D1.HOUR_ID = D2.HOUR_ID AND (TOTAL_DL_SAMPLES is not null OR TOTAL_UL_SAMPLES is not null) ) as FINAL",
	"TC05": "DECLARE @currentDateTime DATE, @date DATETIME SET @currentDateTime = (getdate()) SET @date = CAST(DATEADD(DAY, -7, @currentDateTime) AS DATE) DECLARE @erbsName VARCHAR(100) = ERBS_NODE DECLARE @cellName VARCHAR(100) = CELL_NAME select cast(round(avg(DL_FAILEDSESSIONS_T5),0) as numeric(36,2)) as 'Avg_Failed_User_Session' from ( SELECT D1.DATE_ID AS DATE_ID, D1.HOUR_ID AS HOUR_ID, D1.ERBS AS ERBS, D1.EUtranCellFDD AS EUtranCellFDD,D1.SN AS SN, D1.noFailedDLSessionsT1 AS DL_FAILEDSESSIONS_T1, D1.noFailedDLSessionsT2 AS DL_FAILEDSESSIONS_T2, D1.noFailedDLSessionsT3 AS DL_FAILEDSESSIONS_T3, D1.noFailedDLSessionsT4 AS DL_FAILEDSESSIONS_T4, D1.noFailedDLSessionsT5 AS DL_FAILEDSESSIONS_T5, (D1.noDLSessions + D2.noShortDLSessions) AS TOTAL_DL_SAMPLES , D1.noFailedULSessionsT1 AS UL_FAILEDSESSIONS_T1, D1.noFailedULSessionsT2 AS UL_FAILEDSESSIONS_T2, D1.noFailedULSessionsT3 AS UL_FAILEDSESSIONS_T3, D1.noFailedULSessionsT4 AS UL_FAILEDSESSIONS_T4, D1.noFailedULSessionsT5 AS UL_FAILEDSESSIONS_T5, (D1.noULSessions + D2.noShortULSessions) AS TOTAL_UL_SAMPLES FROM ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellFDD AS EUtranCellFDD,SN AS SN, SUM(case when DCVECTOR_INDEX <= 4 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT1 , SUM(case when DCVECTOR_INDEX <= 5 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT2 , SUM(case when DCVECTOR_INDEX <= 6 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT3 , SUM(case when DCVECTOR_INDEX <= 8 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT4, SUM(case when DCVECTOR_INDEX <= 11 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT5 , SUM(pmUeThpDlMbbFiltered2Distr) as noDLSessions, SUM(case when DCVECTOR_INDEX <= 4 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT1, SUM(case when DCVECTOR_INDEX <= 6 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT2, SUM(case when DCVECTOR_INDEX <= 9 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT3, SUM(case when DCVECTOR_INDEX <= 11 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT4, SUM(case when DCVECTOR_INDEX <= 15 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT5, SUM(pmMacUeThpUlMbbLowVolDistr) as noULSessions FROM DC_E_ERBS_EUTRANCELLFDD_V_RAW DA WHERE DA.DATE_ID >=@date AND DA.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') AND DA.DCVECTOR_INDEX <=26 and ERBS =@erbsName and EUTRANCELLFDD =@cellName GROUP BY DA.DATE_ID, DA.HOUR_ID, DA.ERBS,DA.EUtranCellFDD,DA.SN ) AS D1, ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellFDD AS EUtranCellFDD,SN AS SN, SUM(pmUeExclThpDlShortDrb) as noShortDLSessions, SUM(pmUeExclThpUlRelativeLowVol+pmUeExclThpUlShortTimeLowVol) as noShortULSessions FROM DC_E_ERBS_EUTRANCELLFDD_RAW DB WHERE DB.DATE_ID >=@date AND DB.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') GROUP BY DB.DATE_ID, DB.HOUR_ID, DB.ERBS,DB.EUtranCellFDD,DB.SN ) AS D2 WHERE D1.EUtranCellFDD = D2.EUtranCellFDD AND D1.SN =D2.SN AND D1.DATE_ID = D2.DATE_ID AND D1.HOUR_ID = D2.HOUR_ID AND (TOTAL_DL_SAMPLES is not null OR TOTAL_UL_SAMPLES is not null)   UNION  SELECT D1.DATE_ID AS DATE_ID, D1.HOUR_ID AS HOUR_ID, D1.ERBS AS ERBS, D1.EUtranCellTDD AS EUtranCellTDD,D1.SN AS SN, D1.noFailedDLSessionsT1 AS DL_FAILEDSESSIONS_T1, D1.noFailedDLSessionsT2 AS DL_FAILEDSESSIONS_T2, D1.noFailedDLSessionsT3 AS DL_FAILEDSESSIONS_T3, D1.noFailedDLSessionsT4 AS DL_FAILEDSESSIONS_T4, D1.noFailedDLSessionsT5 AS DL_FAILEDSESSIONS_T5, (D1.noDLSessions + D2.noShortDLSessions) AS TOTAL_DL_SAMPLES , D1.noFailedULSessionsT1 AS UL_FAILEDSESSIONS_T1, D1.noFailedULSessionsT2 AS UL_FAILEDSESSIONS_T2, D1.noFailedULSessionsT3 AS UL_FAILEDSESSIONS_T3, D1.noFailedULSessionsT4 AS UL_FAILEDSESSIONS_T4, D1.noFailedULSessionsT5 AS UL_FAILEDSESSIONS_T5, (D1.noULSessions + D2.noShortULSessions) AS TOTAL_UL_SAMPLES FROM ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellTDD AS EUtranCellTDD,SN AS SN, SUM(case when DCVECTOR_INDEX <= 4 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT1 , SUM(case when DCVECTOR_INDEX <= 5 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT2 , SUM(case when DCVECTOR_INDEX <= 6 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT3 , SUM(case when DCVECTOR_INDEX <= 8 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT4, SUM(case when DCVECTOR_INDEX <= 11 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT5 , SUM(pmUeThpDlMbbFiltered2Distr) as noDLSessions, SUM(case when DCVECTOR_INDEX <= 4 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT1, SUM(case when DCVECTOR_INDEX <= 6 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT2, SUM(case when DCVECTOR_INDEX <= 9 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT3, SUM(case when DCVECTOR_INDEX <= 11 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT4, SUM(case when DCVECTOR_INDEX <= 15 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT5, SUM(pmMacUeThpUlMbbLowVolDistr) as noULSessions FROM DC_E_ERBS_EUTRANCELLTDD_V_RAW DA WHERE DA.DATE_ID >=@date AND DA.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') AND DA.DCVECTOR_INDEX <=26  and  ERBS = @erbsName and EUTRANCELLTDD = @cellName GROUP BY DA.DATE_ID, DA.HOUR_ID, DA.ERBS,DA.EUtranCellTDD,DA.SN ) AS D1, ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellTDD AS EUtranCellTDD,SN AS SN, SUM(pmUeExclThpDlShortDrb) as noShortDLSessions, SUM(pmUeExclThpUlRelativeLowVol+pmUeExclThpUlShortTimeLowVol) as noShortULSessions FROM DC_E_ERBS_EUTRANCELLTDD_RAW DB WHERE DB.DATE_ID >=@date AND DB.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') GROUP BY DB.DATE_ID, DB.HOUR_ID, DB.ERBS,DB.EUtranCellTDD,DB.SN ) AS D2 WHERE D1.EUtranCellTDD = D2.EUtranCellTDD AND D1.SN = D2.SN AND D1.DATE_ID = D2.DATE_ID AND D1.HOUR_ID = D2.HOUR_ID AND (TOTAL_DL_SAMPLES is not null OR TOTAL_UL_SAMPLES is not null) ) as FINAL",
 	"TC06": "DECLARE @currentDateTime DATE, @date DATETIME SET @currentDateTime = (getdate()) SET @date = CAST(DATEADD(DAY, -7, @currentDateTime) AS DATE) DECLARE @erbsName VARCHAR(100) = ERBS_NODE DECLARE @cellName VARCHAR(100) = CELL_NAME select cast(round(avg(UL_FAILEDSESSIONS_T1),0) as numeric(36,2)) as 'Avg_Failed_User_Session' from ( SELECT D1.DATE_ID AS DATE_ID, D1.HOUR_ID AS HOUR_ID, D1.ERBS AS ERBS, D1.EUtranCellFDD AS EUtranCellFDD,D1.SN AS SN, D1.noFailedDLSessionsT1 AS DL_FAILEDSESSIONS_T1, D1.noFailedDLSessionsT2 AS DL_FAILEDSESSIONS_T2, D1.noFailedDLSessionsT3 AS DL_FAILEDSESSIONS_T3, D1.noFailedDLSessionsT4 AS DL_FAILEDSESSIONS_T4, D1.noFailedDLSessionsT5 AS DL_FAILEDSESSIONS_T5, (D1.noDLSessions + D2.noShortDLSessions) AS TOTAL_DL_SAMPLES , D1.noFailedULSessionsT1 AS UL_FAILEDSESSIONS_T1, D1.noFailedULSessionsT2 AS UL_FAILEDSESSIONS_T2, D1.noFailedULSessionsT3 AS UL_FAILEDSESSIONS_T3, D1.noFailedULSessionsT4 AS UL_FAILEDSESSIONS_T4, D1.noFailedULSessionsT5 AS UL_FAILEDSESSIONS_T5, (D1.noULSessions + D2.noShortULSessions) AS TOTAL_UL_SAMPLES FROM ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellFDD AS EUtranCellFDD,SN AS SN, SUM(case when DCVECTOR_INDEX <= 4 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT1 , SUM(case when DCVECTOR_INDEX <= 5 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT2 , SUM(case when DCVECTOR_INDEX <= 6 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT3 , SUM(case when DCVECTOR_INDEX <= 8 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT4, SUM(case when DCVECTOR_INDEX <= 11 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT5 , SUM(pmUeThpDlMbbFiltered2Distr) as noDLSessions, SUM(case when DCVECTOR_INDEX <= 4 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT1, SUM(case when DCVECTOR_INDEX <= 6 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT2, SUM(case when DCVECTOR_INDEX <= 9 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT3, SUM(case when DCVECTOR_INDEX <= 11 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT4, SUM(case when DCVECTOR_INDEX <= 15 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT5, SUM(pmMacUeThpUlMbbLowVolDistr) as noULSessions FROM DC_E_ERBS_EUTRANCELLFDD_V_RAW DA WHERE DA.DATE_ID >=@date AND DA.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') AND DA.DCVECTOR_INDEX <=26 and ERBS =@erbsName and EUTRANCELLFDD =@cellName GROUP BY DA.DATE_ID, DA.HOUR_ID, DA.ERBS,DA.EUtranCellFDD,DA.SN ) AS D1, ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellFDD AS EUtranCellFDD,SN AS SN, SUM(pmUeExclThpDlShortDrb) as noShortDLSessions, SUM(pmUeExclThpUlRelativeLowVol+pmUeExclThpUlShortTimeLowVol) as noShortULSessions FROM DC_E_ERBS_EUTRANCELLFDD_RAW DB WHERE DB.DATE_ID >=@date AND DB.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') GROUP BY DB.DATE_ID, DB.HOUR_ID, DB.ERBS,DB.EUtranCellFDD,DB.SN ) AS D2 WHERE D1.EUtranCellFDD = D2.EUtranCellFDD AND D1.SN =D2.SN AND D1.DATE_ID = D2.DATE_ID AND D1.HOUR_ID = D2.HOUR_ID AND (TOTAL_DL_SAMPLES is not null OR TOTAL_UL_SAMPLES is not null)   UNION  SELECT D1.DATE_ID AS DATE_ID, D1.HOUR_ID AS HOUR_ID, D1.ERBS AS ERBS, D1.EUtranCellTDD AS EUtranCellTDD,D1.SN AS SN, D1.noFailedDLSessionsT1 AS DL_FAILEDSESSIONS_T1, D1.noFailedDLSessionsT2 AS DL_FAILEDSESSIONS_T2, D1.noFailedDLSessionsT3 AS DL_FAILEDSESSIONS_T3, D1.noFailedDLSessionsT4 AS DL_FAILEDSESSIONS_T4, D1.noFailedDLSessionsT5 AS DL_FAILEDSESSIONS_T5, (D1.noDLSessions + D2.noShortDLSessions) AS TOTAL_DL_SAMPLES , D1.noFailedULSessionsT1 AS UL_FAILEDSESSIONS_T1, D1.noFailedULSessionsT2 AS UL_FAILEDSESSIONS_T2, D1.noFailedULSessionsT3 AS UL_FAILEDSESSIONS_T3, D1.noFailedULSessionsT4 AS UL_FAILEDSESSIONS_T4, D1.noFailedULSessionsT5 AS UL_FAILEDSESSIONS_T5, (D1.noULSessions + D2.noShortULSessions) AS TOTAL_UL_SAMPLES FROM ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellTDD AS EUtranCellTDD,SN AS SN, SUM(case when DCVECTOR_INDEX <= 4 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT1 , SUM(case when DCVECTOR_INDEX <= 5 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT2 , SUM(case when DCVECTOR_INDEX <= 6 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT3 , SUM(case when DCVECTOR_INDEX <= 8 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT4, SUM(case when DCVECTOR_INDEX <= 11 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT5 , SUM(pmUeThpDlMbbFiltered2Distr) as noDLSessions, SUM(case when DCVECTOR_INDEX <= 4 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT1, SUM(case when DCVECTOR_INDEX <= 6 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT2, SUM(case when DCVECTOR_INDEX <= 9 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT3, SUM(case when DCVECTOR_INDEX <= 11 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT4, SUM(case when DCVECTOR_INDEX <= 15 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT5, SUM(pmMacUeThpUlMbbLowVolDistr) as noULSessions FROM DC_E_ERBS_EUTRANCELLTDD_V_RAW DA WHERE DA.DATE_ID >=@date AND DA.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') AND DA.DCVECTOR_INDEX <=26  and  ERBS = @erbsName and EUTRANCELLTDD = @cellName GROUP BY DA.DATE_ID, DA.HOUR_ID, DA.ERBS,DA.EUtranCellTDD,DA.SN ) AS D1, ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellTDD AS EUtranCellTDD,SN AS SN, SUM(pmUeExclThpDlShortDrb) as noShortDLSessions, SUM(pmUeExclThpUlRelativeLowVol+pmUeExclThpUlShortTimeLowVol) as noShortULSessions FROM DC_E_ERBS_EUTRANCELLTDD_RAW DB WHERE DB.DATE_ID >=@date AND DB.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') GROUP BY DB.DATE_ID, DB.HOUR_ID, DB.ERBS,DB.EUtranCellTDD,DB.SN ) AS D2 WHERE D1.EUtranCellTDD = D2.EUtranCellTDD AND D1.SN = D2.SN AND D1.DATE_ID = D2.DATE_ID AND D1.HOUR_ID = D2.HOUR_ID AND (TOTAL_DL_SAMPLES is not null OR TOTAL_UL_SAMPLES is not null) ) as FINAL",
	"TC07": "DECLARE @currentDateTime DATE, @date DATETIME SET @currentDateTime = (getdate()) SET @date = CAST(DATEADD(DAY, -7, @currentDateTime) AS DATE) DECLARE @erbsName VARCHAR(100) = ERBS_NODE DECLARE @cellName VARCHAR(100) = CELL_NAME select cast(round(avg(UL_FAILEDSESSIONS_T2),0) as numeric(36,2)) as 'Avg_Failed_User_Session' from ( SELECT D1.DATE_ID AS DATE_ID, D1.HOUR_ID AS HOUR_ID, D1.ERBS AS ERBS, D1.EUtranCellFDD AS EUtranCellFDD,D1.SN AS SN, D1.noFailedDLSessionsT1 AS DL_FAILEDSESSIONS_T1, D1.noFailedDLSessionsT2 AS DL_FAILEDSESSIONS_T2, D1.noFailedDLSessionsT3 AS DL_FAILEDSESSIONS_T3, D1.noFailedDLSessionsT4 AS DL_FAILEDSESSIONS_T4, D1.noFailedDLSessionsT5 AS DL_FAILEDSESSIONS_T5, (D1.noDLSessions + D2.noShortDLSessions) AS TOTAL_DL_SAMPLES , D1.noFailedULSessionsT1 AS UL_FAILEDSESSIONS_T1, D1.noFailedULSessionsT2 AS UL_FAILEDSESSIONS_T2, D1.noFailedULSessionsT3 AS UL_FAILEDSESSIONS_T3, D1.noFailedULSessionsT4 AS UL_FAILEDSESSIONS_T4, D1.noFailedULSessionsT5 AS UL_FAILEDSESSIONS_T5, (D1.noULSessions + D2.noShortULSessions) AS TOTAL_UL_SAMPLES FROM ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellFDD AS EUtranCellFDD,SN AS SN, SUM(case when DCVECTOR_INDEX <= 4 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT1 , SUM(case when DCVECTOR_INDEX <= 5 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT2 , SUM(case when DCVECTOR_INDEX <= 6 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT3 , SUM(case when DCVECTOR_INDEX <= 8 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT4, SUM(case when DCVECTOR_INDEX <= 11 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT5 , SUM(pmUeThpDlMbbFiltered2Distr) as noDLSessions, SUM(case when DCVECTOR_INDEX <= 4 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT1, SUM(case when DCVECTOR_INDEX <= 6 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT2, SUM(case when DCVECTOR_INDEX <= 9 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT3, SUM(case when DCVECTOR_INDEX <= 11 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT4, SUM(case when DCVECTOR_INDEX <= 15 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT5, SUM(pmMacUeThpUlMbbLowVolDistr) as noULSessions FROM DC_E_ERBS_EUTRANCELLFDD_V_RAW DA WHERE DA.DATE_ID >=@date AND DA.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') AND DA.DCVECTOR_INDEX <=26 and ERBS =@erbsName and EUTRANCELLFDD =@cellName GROUP BY DA.DATE_ID, DA.HOUR_ID, DA.ERBS,DA.EUtranCellFDD,DA.SN ) AS D1, ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellFDD AS EUtranCellFDD,SN AS SN, SUM(pmUeExclThpDlShortDrb) as noShortDLSessions, SUM(pmUeExclThpUlRelativeLowVol+pmUeExclThpUlShortTimeLowVol) as noShortULSessions FROM DC_E_ERBS_EUTRANCELLFDD_RAW DB WHERE DB.DATE_ID >=@date AND DB.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') GROUP BY DB.DATE_ID, DB.HOUR_ID, DB.ERBS,DB.EUtranCellFDD,DB.SN ) AS D2 WHERE D1.EUtranCellFDD = D2.EUtranCellFDD AND D1.SN =D2.SN AND D1.DATE_ID = D2.DATE_ID AND D1.HOUR_ID = D2.HOUR_ID AND (TOTAL_DL_SAMPLES is not null OR TOTAL_UL_SAMPLES is not null)   UNION  SELECT D1.DATE_ID AS DATE_ID, D1.HOUR_ID AS HOUR_ID, D1.ERBS AS ERBS, D1.EUtranCellTDD AS EUtranCellTDD,D1.SN AS SN, D1.noFailedDLSessionsT1 AS DL_FAILEDSESSIONS_T1, D1.noFailedDLSessionsT2 AS DL_FAILEDSESSIONS_T2, D1.noFailedDLSessionsT3 AS DL_FAILEDSESSIONS_T3, D1.noFailedDLSessionsT4 AS DL_FAILEDSESSIONS_T4, D1.noFailedDLSessionsT5 AS DL_FAILEDSESSIONS_T5, (D1.noDLSessions + D2.noShortDLSessions) AS TOTAL_DL_SAMPLES , D1.noFailedULSessionsT1 AS UL_FAILEDSESSIONS_T1, D1.noFailedULSessionsT2 AS UL_FAILEDSESSIONS_T2, D1.noFailedULSessionsT3 AS UL_FAILEDSESSIONS_T3, D1.noFailedULSessionsT4 AS UL_FAILEDSESSIONS_T4, D1.noFailedULSessionsT5 AS UL_FAILEDSESSIONS_T5, (D1.noULSessions + D2.noShortULSessions) AS TOTAL_UL_SAMPLES FROM ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellTDD AS EUtranCellTDD,SN AS SN, SUM(case when DCVECTOR_INDEX <= 4 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT1 , SUM(case when DCVECTOR_INDEX <= 5 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT2 , SUM(case when DCVECTOR_INDEX <= 6 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT3 , SUM(case when DCVECTOR_INDEX <= 8 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT4, SUM(case when DCVECTOR_INDEX <= 11 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT5 , SUM(pmUeThpDlMbbFiltered2Distr) as noDLSessions, SUM(case when DCVECTOR_INDEX <= 4 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT1, SUM(case when DCVECTOR_INDEX <= 6 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT2, SUM(case when DCVECTOR_INDEX <= 9 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT3, SUM(case when DCVECTOR_INDEX <= 11 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT4, SUM(case when DCVECTOR_INDEX <= 15 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT5, SUM(pmMacUeThpUlMbbLowVolDistr) as noULSessions FROM DC_E_ERBS_EUTRANCELLTDD_V_RAW DA WHERE DA.DATE_ID >=@date AND DA.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') AND DA.DCVECTOR_INDEX <=26  and  ERBS = @erbsName and EUTRANCELLTDD = @cellName GROUP BY DA.DATE_ID, DA.HOUR_ID, DA.ERBS,DA.EUtranCellTDD,DA.SN ) AS D1, ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellTDD AS EUtranCellTDD,SN AS SN, SUM(pmUeExclThpDlShortDrb) as noShortDLSessions, SUM(pmUeExclThpUlRelativeLowVol+pmUeExclThpUlShortTimeLowVol) as noShortULSessions FROM DC_E_ERBS_EUTRANCELLTDD_RAW DB WHERE DB.DATE_ID >=@date AND DB.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') GROUP BY DB.DATE_ID, DB.HOUR_ID, DB.ERBS,DB.EUtranCellTDD,DB.SN ) AS D2 WHERE D1.EUtranCellTDD = D2.EUtranCellTDD AND D1.SN = D2.SN AND D1.DATE_ID = D2.DATE_ID AND D1.HOUR_ID = D2.HOUR_ID AND (TOTAL_DL_SAMPLES is not null OR TOTAL_UL_SAMPLES is not null) ) as FINAL",
	"TC08": "DECLARE @currentDateTime DATE, @date DATETIME SET @currentDateTime = (getdate()) SET @date = CAST(DATEADD(DAY, -7, @currentDateTime) AS DATE) DECLARE @erbsName VARCHAR(100) = ERBS_NODE DECLARE @cellName VARCHAR(100) = CELL_NAME select cast(round(avg(UL_FAILEDSESSIONS_T3),0) as numeric(36,2)) as 'Avg_Failed_User_Session' from ( SELECT D1.DATE_ID AS DATE_ID, D1.HOUR_ID AS HOUR_ID, D1.ERBS AS ERBS, D1.EUtranCellFDD AS EUtranCellFDD,D1.SN AS SN, D1.noFailedDLSessionsT1 AS DL_FAILEDSESSIONS_T1, D1.noFailedDLSessionsT2 AS DL_FAILEDSESSIONS_T2, D1.noFailedDLSessionsT3 AS DL_FAILEDSESSIONS_T3, D1.noFailedDLSessionsT4 AS DL_FAILEDSESSIONS_T4, D1.noFailedDLSessionsT5 AS DL_FAILEDSESSIONS_T5, (D1.noDLSessions + D2.noShortDLSessions) AS TOTAL_DL_SAMPLES , D1.noFailedULSessionsT1 AS UL_FAILEDSESSIONS_T1, D1.noFailedULSessionsT2 AS UL_FAILEDSESSIONS_T2, D1.noFailedULSessionsT3 AS UL_FAILEDSESSIONS_T3, D1.noFailedULSessionsT4 AS UL_FAILEDSESSIONS_T4, D1.noFailedULSessionsT5 AS UL_FAILEDSESSIONS_T5, (D1.noULSessions + D2.noShortULSessions) AS TOTAL_UL_SAMPLES FROM ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellFDD AS EUtranCellFDD,SN AS SN, SUM(case when DCVECTOR_INDEX <= 4 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT1 , SUM(case when DCVECTOR_INDEX <= 5 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT2 , SUM(case when DCVECTOR_INDEX <= 6 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT3 , SUM(case when DCVECTOR_INDEX <= 8 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT4, SUM(case when DCVECTOR_INDEX <= 11 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT5 , SUM(pmUeThpDlMbbFiltered2Distr) as noDLSessions, SUM(case when DCVECTOR_INDEX <= 4 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT1, SUM(case when DCVECTOR_INDEX <= 6 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT2, SUM(case when DCVECTOR_INDEX <= 9 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT3, SUM(case when DCVECTOR_INDEX <= 11 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT4, SUM(case when DCVECTOR_INDEX <= 15 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT5, SUM(pmMacUeThpUlMbbLowVolDistr) as noULSessions FROM DC_E_ERBS_EUTRANCELLFDD_V_RAW DA WHERE DA.DATE_ID >=@date AND DA.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') AND DA.DCVECTOR_INDEX <=26 and ERBS =@erbsName and EUTRANCELLFDD =@cellName GROUP BY DA.DATE_ID, DA.HOUR_ID, DA.ERBS,DA.EUtranCellFDD,DA.SN ) AS D1, ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellFDD AS EUtranCellFDD,SN AS SN, SUM(pmUeExclThpDlShortDrb) as noShortDLSessions, SUM(pmUeExclThpUlRelativeLowVol+pmUeExclThpUlShortTimeLowVol) as noShortULSessions FROM DC_E_ERBS_EUTRANCELLFDD_RAW DB WHERE DB.DATE_ID >=@date AND DB.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') GROUP BY DB.DATE_ID, DB.HOUR_ID, DB.ERBS,DB.EUtranCellFDD,DB.SN ) AS D2 WHERE D1.EUtranCellFDD = D2.EUtranCellFDD AND D1.SN =D2.SN AND D1.DATE_ID = D2.DATE_ID AND D1.HOUR_ID = D2.HOUR_ID AND (TOTAL_DL_SAMPLES is not null OR TOTAL_UL_SAMPLES is not null)   UNION  SELECT D1.DATE_ID AS DATE_ID, D1.HOUR_ID AS HOUR_ID, D1.ERBS AS ERBS, D1.EUtranCellTDD AS EUtranCellTDD,D1.SN AS SN, D1.noFailedDLSessionsT1 AS DL_FAILEDSESSIONS_T1, D1.noFailedDLSessionsT2 AS DL_FAILEDSESSIONS_T2, D1.noFailedDLSessionsT3 AS DL_FAILEDSESSIONS_T3, D1.noFailedDLSessionsT4 AS DL_FAILEDSESSIONS_T4, D1.noFailedDLSessionsT5 AS DL_FAILEDSESSIONS_T5, (D1.noDLSessions + D2.noShortDLSessions) AS TOTAL_DL_SAMPLES , D1.noFailedULSessionsT1 AS UL_FAILEDSESSIONS_T1, D1.noFailedULSessionsT2 AS UL_FAILEDSESSIONS_T2, D1.noFailedULSessionsT3 AS UL_FAILEDSESSIONS_T3, D1.noFailedULSessionsT4 AS UL_FAILEDSESSIONS_T4, D1.noFailedULSessionsT5 AS UL_FAILEDSESSIONS_T5, (D1.noULSessions + D2.noShortULSessions) AS TOTAL_UL_SAMPLES FROM ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellTDD AS EUtranCellTDD,SN AS SN, SUM(case when DCVECTOR_INDEX <= 4 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT1 , SUM(case when DCVECTOR_INDEX <= 5 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT2 , SUM(case when DCVECTOR_INDEX <= 6 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT3 , SUM(case when DCVECTOR_INDEX <= 8 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT4, SUM(case when DCVECTOR_INDEX <= 11 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT5 , SUM(pmUeThpDlMbbFiltered2Distr) as noDLSessions, SUM(case when DCVECTOR_INDEX <= 4 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT1, SUM(case when DCVECTOR_INDEX <= 6 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT2, SUM(case when DCVECTOR_INDEX <= 9 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT3, SUM(case when DCVECTOR_INDEX <= 11 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT4, SUM(case when DCVECTOR_INDEX <= 15 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT5, SUM(pmMacUeThpUlMbbLowVolDistr) as noULSessions FROM DC_E_ERBS_EUTRANCELLTDD_V_RAW DA WHERE DA.DATE_ID >=@date AND DA.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') AND DA.DCVECTOR_INDEX <=26  and  ERBS = @erbsName and EUTRANCELLTDD = @cellName GROUP BY DA.DATE_ID, DA.HOUR_ID, DA.ERBS,DA.EUtranCellTDD,DA.SN ) AS D1, ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellTDD AS EUtranCellTDD,SN AS SN, SUM(pmUeExclThpDlShortDrb) as noShortDLSessions, SUM(pmUeExclThpUlRelativeLowVol+pmUeExclThpUlShortTimeLowVol) as noShortULSessions FROM DC_E_ERBS_EUTRANCELLTDD_RAW DB WHERE DB.DATE_ID >=@date AND DB.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') GROUP BY DB.DATE_ID, DB.HOUR_ID, DB.ERBS,DB.EUtranCellTDD,DB.SN ) AS D2 WHERE D1.EUtranCellTDD = D2.EUtranCellTDD AND D1.SN = D2.SN AND D1.DATE_ID = D2.DATE_ID AND D1.HOUR_ID = D2.HOUR_ID AND (TOTAL_DL_SAMPLES is not null OR TOTAL_UL_SAMPLES is not null) ) as FINAL",
	"TC09": "DECLARE @currentDateTime DATE, @date DATETIME SET @currentDateTime = (getdate()) SET @date = CAST(DATEADD(DAY, -7, @currentDateTime) AS DATE) DECLARE @erbsName VARCHAR(100) = ERBS_NODE DECLARE @cellName VARCHAR(100) = CELL_NAME select cast(round(avg(UL_FAILEDSESSIONS_T4),0) as numeric(36,2)) as 'Avg_Failed_User_Session' from ( SELECT D1.DATE_ID AS DATE_ID, D1.HOUR_ID AS HOUR_ID, D1.ERBS AS ERBS, D1.EUtranCellFDD AS EUtranCellFDD,D1.SN AS SN, D1.noFailedDLSessionsT1 AS DL_FAILEDSESSIONS_T1, D1.noFailedDLSessionsT2 AS DL_FAILEDSESSIONS_T2, D1.noFailedDLSessionsT3 AS DL_FAILEDSESSIONS_T3, D1.noFailedDLSessionsT4 AS DL_FAILEDSESSIONS_T4, D1.noFailedDLSessionsT5 AS DL_FAILEDSESSIONS_T5, (D1.noDLSessions + D2.noShortDLSessions) AS TOTAL_DL_SAMPLES , D1.noFailedULSessionsT1 AS UL_FAILEDSESSIONS_T1, D1.noFailedULSessionsT2 AS UL_FAILEDSESSIONS_T2, D1.noFailedULSessionsT3 AS UL_FAILEDSESSIONS_T3, D1.noFailedULSessionsT4 AS UL_FAILEDSESSIONS_T4, D1.noFailedULSessionsT5 AS UL_FAILEDSESSIONS_T5, (D1.noULSessions + D2.noShortULSessions) AS TOTAL_UL_SAMPLES FROM ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellFDD AS EUtranCellFDD,SN AS SN, SUM(case when DCVECTOR_INDEX <= 4 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT1 , SUM(case when DCVECTOR_INDEX <= 5 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT2 , SUM(case when DCVECTOR_INDEX <= 6 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT3 , SUM(case when DCVECTOR_INDEX <= 8 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT4, SUM(case when DCVECTOR_INDEX <= 11 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT5 , SUM(pmUeThpDlMbbFiltered2Distr) as noDLSessions, SUM(case when DCVECTOR_INDEX <= 4 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT1, SUM(case when DCVECTOR_INDEX <= 6 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT2, SUM(case when DCVECTOR_INDEX <= 9 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT3, SUM(case when DCVECTOR_INDEX <= 11 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT4, SUM(case when DCVECTOR_INDEX <= 15 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT5, SUM(pmMacUeThpUlMbbLowVolDistr) as noULSessions FROM DC_E_ERBS_EUTRANCELLFDD_V_RAW DA WHERE DA.DATE_ID >=@date AND DA.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') AND DA.DCVECTOR_INDEX <=26 and ERBS =@erbsName and EUTRANCELLFDD =@cellName GROUP BY DA.DATE_ID, DA.HOUR_ID, DA.ERBS,DA.EUtranCellFDD,DA.SN ) AS D1, ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellFDD AS EUtranCellFDD,SN AS SN, SUM(pmUeExclThpDlShortDrb) as noShortDLSessions, SUM(pmUeExclThpUlRelativeLowVol+pmUeExclThpUlShortTimeLowVol) as noShortULSessions FROM DC_E_ERBS_EUTRANCELLFDD_RAW DB WHERE DB.DATE_ID >=@date AND DB.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') GROUP BY DB.DATE_ID, DB.HOUR_ID, DB.ERBS,DB.EUtranCellFDD,DB.SN ) AS D2 WHERE D1.EUtranCellFDD = D2.EUtranCellFDD AND D1.SN =D2.SN AND D1.DATE_ID = D2.DATE_ID AND D1.HOUR_ID = D2.HOUR_ID AND (TOTAL_DL_SAMPLES is not null OR TOTAL_UL_SAMPLES is not null)   UNION  SELECT D1.DATE_ID AS DATE_ID, D1.HOUR_ID AS HOUR_ID, D1.ERBS AS ERBS, D1.EUtranCellTDD AS EUtranCellTDD,D1.SN AS SN, D1.noFailedDLSessionsT1 AS DL_FAILEDSESSIONS_T1, D1.noFailedDLSessionsT2 AS DL_FAILEDSESSIONS_T2, D1.noFailedDLSessionsT3 AS DL_FAILEDSESSIONS_T3, D1.noFailedDLSessionsT4 AS DL_FAILEDSESSIONS_T4, D1.noFailedDLSessionsT5 AS DL_FAILEDSESSIONS_T5, (D1.noDLSessions + D2.noShortDLSessions) AS TOTAL_DL_SAMPLES , D1.noFailedULSessionsT1 AS UL_FAILEDSESSIONS_T1, D1.noFailedULSessionsT2 AS UL_FAILEDSESSIONS_T2, D1.noFailedULSessionsT3 AS UL_FAILEDSESSIONS_T3, D1.noFailedULSessionsT4 AS UL_FAILEDSESSIONS_T4, D1.noFailedULSessionsT5 AS UL_FAILEDSESSIONS_T5, (D1.noULSessions + D2.noShortULSessions) AS TOTAL_UL_SAMPLES FROM ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellTDD AS EUtranCellTDD,SN AS SN, SUM(case when DCVECTOR_INDEX <= 4 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT1 , SUM(case when DCVECTOR_INDEX <= 5 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT2 , SUM(case when DCVECTOR_INDEX <= 6 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT3 , SUM(case when DCVECTOR_INDEX <= 8 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT4, SUM(case when DCVECTOR_INDEX <= 11 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT5 , SUM(pmUeThpDlMbbFiltered2Distr) as noDLSessions, SUM(case when DCVECTOR_INDEX <= 4 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT1, SUM(case when DCVECTOR_INDEX <= 6 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT2, SUM(case when DCVECTOR_INDEX <= 9 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT3, SUM(case when DCVECTOR_INDEX <= 11 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT4, SUM(case when DCVECTOR_INDEX <= 15 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT5, SUM(pmMacUeThpUlMbbLowVolDistr) as noULSessions FROM DC_E_ERBS_EUTRANCELLTDD_V_RAW DA WHERE DA.DATE_ID >=@date AND DA.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') AND DA.DCVECTOR_INDEX <=26  and  ERBS = @erbsName and EUTRANCELLTDD = @cellName GROUP BY DA.DATE_ID, DA.HOUR_ID, DA.ERBS,DA.EUtranCellTDD,DA.SN ) AS D1, ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellTDD AS EUtranCellTDD,SN AS SN, SUM(pmUeExclThpDlShortDrb) as noShortDLSessions, SUM(pmUeExclThpUlRelativeLowVol+pmUeExclThpUlShortTimeLowVol) as noShortULSessions FROM DC_E_ERBS_EUTRANCELLTDD_RAW DB WHERE DB.DATE_ID >=@date AND DB.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') GROUP BY DB.DATE_ID, DB.HOUR_ID, DB.ERBS,DB.EUtranCellTDD,DB.SN ) AS D2 WHERE D1.EUtranCellTDD = D2.EUtranCellTDD AND D1.SN = D2.SN AND D1.DATE_ID = D2.DATE_ID AND D1.HOUR_ID = D2.HOUR_ID AND (TOTAL_DL_SAMPLES is not null OR TOTAL_UL_SAMPLES is not null) ) as FINAL",
	"TC10": "DECLARE @currentDateTime DATE, @date DATETIME SET @currentDateTime = (getdate()) SET @date = CAST(DATEADD(DAY, -7, @currentDateTime) AS DATE) DECLARE @erbsName VARCHAR(100) = ERBS_NODE DECLARE @cellName VARCHAR(100) = CELL_NAME select cast(round(avg(UL_FAILEDSESSIONS_T5),0) as numeric(36,2)) as 'Avg_Failed_User_Session' from ( SELECT D1.DATE_ID AS DATE_ID, D1.HOUR_ID AS HOUR_ID, D1.ERBS AS ERBS, D1.EUtranCellFDD AS EUtranCellFDD,D1.SN AS SN, D1.noFailedDLSessionsT1 AS DL_FAILEDSESSIONS_T1, D1.noFailedDLSessionsT2 AS DL_FAILEDSESSIONS_T2, D1.noFailedDLSessionsT3 AS DL_FAILEDSESSIONS_T3, D1.noFailedDLSessionsT4 AS DL_FAILEDSESSIONS_T4, D1.noFailedDLSessionsT5 AS DL_FAILEDSESSIONS_T5, (D1.noDLSessions + D2.noShortDLSessions) AS TOTAL_DL_SAMPLES , D1.noFailedULSessionsT1 AS UL_FAILEDSESSIONS_T1, D1.noFailedULSessionsT2 AS UL_FAILEDSESSIONS_T2, D1.noFailedULSessionsT3 AS UL_FAILEDSESSIONS_T3, D1.noFailedULSessionsT4 AS UL_FAILEDSESSIONS_T4, D1.noFailedULSessionsT5 AS UL_FAILEDSESSIONS_T5, (D1.noULSessions + D2.noShortULSessions) AS TOTAL_UL_SAMPLES FROM ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellFDD AS EUtranCellFDD,SN AS SN, SUM(case when DCVECTOR_INDEX <= 4 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT1 , SUM(case when DCVECTOR_INDEX <= 5 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT2 , SUM(case when DCVECTOR_INDEX <= 6 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT3 , SUM(case when DCVECTOR_INDEX <= 8 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT4, SUM(case when DCVECTOR_INDEX <= 11 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT5 , SUM(pmUeThpDlMbbFiltered2Distr) as noDLSessions, SUM(case when DCVECTOR_INDEX <= 4 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT1, SUM(case when DCVECTOR_INDEX <= 6 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT2, SUM(case when DCVECTOR_INDEX <= 9 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT3, SUM(case when DCVECTOR_INDEX <= 11 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT4, SUM(case when DCVECTOR_INDEX <= 15 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT5, SUM(pmMacUeThpUlMbbLowVolDistr) as noULSessions FROM DC_E_ERBS_EUTRANCELLFDD_V_RAW DA WHERE DA.DATE_ID >=@date AND DA.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') AND DA.DCVECTOR_INDEX <=26 and ERBS =@erbsName and EUTRANCELLFDD =@cellName GROUP BY DA.DATE_ID, DA.HOUR_ID, DA.ERBS,DA.EUtranCellFDD,DA.SN ) AS D1, ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellFDD AS EUtranCellFDD,SN AS SN, SUM(pmUeExclThpDlShortDrb) as noShortDLSessions, SUM(pmUeExclThpUlRelativeLowVol+pmUeExclThpUlShortTimeLowVol) as noShortULSessions FROM DC_E_ERBS_EUTRANCELLFDD_RAW DB WHERE DB.DATE_ID >=@date AND DB.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') GROUP BY DB.DATE_ID, DB.HOUR_ID, DB.ERBS,DB.EUtranCellFDD,DB.SN ) AS D2 WHERE D1.EUtranCellFDD = D2.EUtranCellFDD AND D1.SN =D2.SN AND D1.DATE_ID = D2.DATE_ID AND D1.HOUR_ID = D2.HOUR_ID AND (TOTAL_DL_SAMPLES is not null OR TOTAL_UL_SAMPLES is not null)   UNION  SELECT D1.DATE_ID AS DATE_ID, D1.HOUR_ID AS HOUR_ID, D1.ERBS AS ERBS, D1.EUtranCellTDD AS EUtranCellTDD,D1.SN AS SN, D1.noFailedDLSessionsT1 AS DL_FAILEDSESSIONS_T1, D1.noFailedDLSessionsT2 AS DL_FAILEDSESSIONS_T2, D1.noFailedDLSessionsT3 AS DL_FAILEDSESSIONS_T3, D1.noFailedDLSessionsT4 AS DL_FAILEDSESSIONS_T4, D1.noFailedDLSessionsT5 AS DL_FAILEDSESSIONS_T5, (D1.noDLSessions + D2.noShortDLSessions) AS TOTAL_DL_SAMPLES , D1.noFailedULSessionsT1 AS UL_FAILEDSESSIONS_T1, D1.noFailedULSessionsT2 AS UL_FAILEDSESSIONS_T2, D1.noFailedULSessionsT3 AS UL_FAILEDSESSIONS_T3, D1.noFailedULSessionsT4 AS UL_FAILEDSESSIONS_T4, D1.noFailedULSessionsT5 AS UL_FAILEDSESSIONS_T5, (D1.noULSessions + D2.noShortULSessions) AS TOTAL_UL_SAMPLES FROM ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellTDD AS EUtranCellTDD,SN AS SN, SUM(case when DCVECTOR_INDEX <= 4 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT1 , SUM(case when DCVECTOR_INDEX <= 5 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT2 , SUM(case when DCVECTOR_INDEX <= 6 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT3 , SUM(case when DCVECTOR_INDEX <= 8 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT4, SUM(case when DCVECTOR_INDEX <= 11 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT5 , SUM(pmUeThpDlMbbFiltered2Distr) as noDLSessions, SUM(case when DCVECTOR_INDEX <= 4 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT1, SUM(case when DCVECTOR_INDEX <= 6 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT2, SUM(case when DCVECTOR_INDEX <= 9 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT3, SUM(case when DCVECTOR_INDEX <= 11 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT4, SUM(case when DCVECTOR_INDEX <= 15 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT5, SUM(pmMacUeThpUlMbbLowVolDistr) as noULSessions FROM DC_E_ERBS_EUTRANCELLTDD_V_RAW DA WHERE DA.DATE_ID >=@date AND DA.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') AND DA.DCVECTOR_INDEX <=26  and  ERBS = @erbsName and EUTRANCELLTDD = @cellName GROUP BY DA.DATE_ID, DA.HOUR_ID, DA.ERBS,DA.EUtranCellTDD,DA.SN ) AS D1, ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellTDD AS EUtranCellTDD,SN AS SN, SUM(pmUeExclThpDlShortDrb) as noShortDLSessions, SUM(pmUeExclThpUlRelativeLowVol+pmUeExclThpUlShortTimeLowVol) as noShortULSessions FROM DC_E_ERBS_EUTRANCELLTDD_RAW DB WHERE DB.DATE_ID >=@date AND DB.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') GROUP BY DB.DATE_ID, DB.HOUR_ID, DB.ERBS,DB.EUtranCellTDD,DB.SN ) AS D2 WHERE D1.EUtranCellTDD = D2.EUtranCellTDD AND D1.SN = D2.SN AND D1.DATE_ID = D2.DATE_ID AND D1.HOUR_ID = D2.HOUR_ID AND (TOTAL_DL_SAMPLES is not null OR TOTAL_UL_SAMPLES is not null) ) as FINAL",
	"TC11": "DECLARE @currentDateTime DATE, @date DATETIME SET @currentDateTime = (getdate()) SET @date = CAST(DATEADD(DAY, -7, @currentDateTime) AS DATE) DECLARE @erbsName VARCHAR(100) = ERBS_NODE DECLARE @cellName VARCHAR(100) = CELL_NAME DECLARE @hourID VARCHAR(3) = HOURID DECLARE @dateID VARCHAR(15) = DATEID select cast(round(avg(DL_FAILEDSESSIONS_T1),0) as numeric(36,2)) as 'AvgFailedUserSession', cast(round((avg(DL_FAILEDSESSIONS_T1)/avg(TOTAL_DL_SAMPLES))*100,0) as numeric(36,2)) as 'FailureRatio' from ( SELECT D1.DATE_ID AS DATE_ID, D1.HOUR_ID AS HOUR_ID, D1.ERBS AS ERBS, D1.EUtranCellFDD AS EUtranCellFDD,D1.SN AS SN, D1.noFailedDLSessionsT1 AS DL_FAILEDSESSIONS_T1, D1.noFailedDLSessionsT2 AS DL_FAILEDSESSIONS_T2, D1.noFailedDLSessionsT3 AS DL_FAILEDSESSIONS_T3, D1.noFailedDLSessionsT4 AS DL_FAILEDSESSIONS_T4, D1.noFailedDLSessionsT5 AS DL_FAILEDSESSIONS_T5, (D1.noDLSessions + D2.noShortDLSessions) AS TOTAL_DL_SAMPLES , D1.noFailedULSessionsT1 AS UL_FAILEDSESSIONS_T1, D1.noFailedULSessionsT2 AS UL_FAILEDSESSIONS_T2, D1.noFailedULSessionsT3 AS UL_FAILEDSESSIONS_T3, D1.noFailedULSessionsT4 AS UL_FAILEDSESSIONS_T4, D1.noFailedULSessionsT5 AS UL_FAILEDSESSIONS_T5, (D1.noULSessions + D2.noShortULSessions) AS TOTAL_UL_SAMPLES FROM ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellFDD AS EUtranCellFDD,SN AS SN, SUM(case when DCVECTOR_INDEX <= 4 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT1 , SUM(case when DCVECTOR_INDEX <= 5 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT2 , SUM(case when DCVECTOR_INDEX <= 6 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT3 , SUM(case when DCVECTOR_INDEX <= 8 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT4, SUM(case when DCVECTOR_INDEX <= 11 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT5 , SUM(pmUeThpDlMbbFiltered2Distr) as noDLSessions, SUM(case when DCVECTOR_INDEX <= 4 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT1, SUM(case when DCVECTOR_INDEX <= 6 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT2, SUM(case when DCVECTOR_INDEX <= 9 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT3, SUM(case when DCVECTOR_INDEX <= 11 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT4, SUM(case when DCVECTOR_INDEX <= 15 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT5, SUM(pmMacUeThpUlMbbLowVolDistr) as noULSessions FROM DC_E_ERBS_EUTRANCELLFDD_V_RAW DA WHERE DA.DATE_ID = @dateID AND DA.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') AND DA.DCVECTOR_INDEX <=26  and ERBS = @erbsName and EUTRANCELLFDD = @cellName and HOUR_ID= @hourID GROUP BY DA.DATE_ID, DA.HOUR_ID, DA.ERBS,DA.EUtranCellFDD,DA.SN ) AS D1, ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellFDD AS EUtranCellFDD,SN AS SN, SUM(pmUeExclThpDlShortDrb) as noShortDLSessions, SUM(pmUeExclThpUlRelativeLowVol+pmUeExclThpUlShortTimeLowVol) as noShortULSessions FROM DC_E_ERBS_EUTRANCELLFDD_RAW DB WHERE DB.DATE_ID =@dateID AND DB.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') GROUP BY DB.DATE_ID, DB.HOUR_ID, DB.ERBS,DB.EUtranCellFDD,DB.SN ) AS D2 WHERE D1.EUtranCellFDD = D2.EUtranCellFDD AND D1.SN =D2.SN AND D1.DATE_ID = D2.DATE_ID AND D1.HOUR_ID = D2.HOUR_ID AND (TOTAL_DL_SAMPLES is not null OR TOTAL_UL_SAMPLES is not null)   UNION  SELECT D1.DATE_ID AS DATE_ID, D1.HOUR_ID AS HOUR_ID, D1.ERBS AS ERBS, D1.EUtranCellTDD AS EUtranCellTDD,D1.SN AS SN, D1.noFailedDLSessionsT1 AS DL_FAILEDSESSIONS_T1, D1.noFailedDLSessionsT2 AS DL_FAILEDSESSIONS_T2, D1.noFailedDLSessionsT3 AS DL_FAILEDSESSIONS_T3, D1.noFailedDLSessionsT4 AS DL_FAILEDSESSIONS_T4, D1.noFailedDLSessionsT5 AS DL_FAILEDSESSIONS_T5, (D1.noDLSessions + D2.noShortDLSessions) AS TOTAL_DL_SAMPLES , D1.noFailedULSessionsT1 AS UL_FAILEDSESSIONS_T1, D1.noFailedULSessionsT2 AS UL_FAILEDSESSIONS_T2, D1.noFailedULSessionsT3 AS UL_FAILEDSESSIONS_T3, D1.noFailedULSessionsT4 AS UL_FAILEDSESSIONS_T4, D1.noFailedULSessionsT5 AS UL_FAILEDSESSIONS_T5, (D1.noULSessions + D2.noShortULSessions) AS TOTAL_UL_SAMPLES FROM ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellTDD AS EUtranCellTDD,SN AS SN, SUM(case when DCVECTOR_INDEX <= 4 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT1 , SUM(case when DCVECTOR_INDEX <= 5 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT2 , SUM(case when DCVECTOR_INDEX <= 6 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT3 , SUM(case when DCVECTOR_INDEX <= 8 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT4, SUM(case when DCVECTOR_INDEX <= 11 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT5 , SUM(pmUeThpDlMbbFiltered2Distr) as noDLSessions, SUM(case when DCVECTOR_INDEX <= 4 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT1, SUM(case when DCVECTOR_INDEX <= 6 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT2, SUM(case when DCVECTOR_INDEX <= 9 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT3, SUM(case when DCVECTOR_INDEX <= 11 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT4, SUM(case when DCVECTOR_INDEX <= 15 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT5, SUM(pmMacUeThpUlMbbLowVolDistr) as noULSessions FROM DC_E_ERBS_EUTRANCELLTDD_V_RAW DA WHERE DA.DATE_ID =@dateID AND DA.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') AND DA.DCVECTOR_INDEX <=26  and  ERBS = @erbsName and EUTRANCELLTDD = @cellName and HOUR_ID =@hourID GROUP BY DA.DATE_ID, DA.HOUR_ID, DA.ERBS,DA.EUtranCellTDD,DA.SN ) AS D1, ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellTDD AS EUtranCellTDD,SN AS SN, SUM(pmUeExclThpDlShortDrb) as noShortDLSessions, SUM(pmUeExclThpUlRelativeLowVol+pmUeExclThpUlShortTimeLowVol) as noShortULSessions FROM DC_E_ERBS_EUTRANCELLTDD_RAW DB WHERE DB.DATE_ID =@dateID AND DB.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') GROUP BY DB.DATE_ID, DB.HOUR_ID, DB.ERBS,DB.EUtranCellTDD,DB.SN ) AS D2 WHERE D1.EUtranCellTDD = D2.EUtranCellTDD AND D1.SN = D2.SN AND D1.DATE_ID = D2.DATE_ID AND D1.HOUR_ID = D2.HOUR_ID AND (TOTAL_DL_SAMPLES is not null OR TOTAL_UL_SAMPLES is not null) ) as Final",
	"TC12": "DECLARE @currentDateTime DATE, @date DATETIME SET @currentDateTime = (getdate()) SET @date = CAST(DATEADD(DAY, -7, @currentDateTime) AS DATE) DECLARE @erbsName VARCHAR(100) = ERBS_NODE DECLARE @cellName VARCHAR(100) = CELL_NAME DECLARE @hourID VARCHAR(3) = HOURID DECLARE @dateID VARCHAR(15) = DATEID select cast(round(avg(DL_FAILEDSESSIONS_T2),0) as numeric(36,2)) as 'AvgFailedUserSession', cast(round((avg(DL_FAILEDSESSIONS_T2)/avg(TOTAL_DL_SAMPLES))*100,0) as numeric(36,2)) as 'FailureRatio' from ( SELECT D1.DATE_ID AS DATE_ID, D1.HOUR_ID AS HOUR_ID, D1.ERBS AS ERBS, D1.EUtranCellFDD AS EUtranCellFDD,D1.SN AS SN, D1.noFailedDLSessionsT1 AS DL_FAILEDSESSIONS_T1, D1.noFailedDLSessionsT2 AS DL_FAILEDSESSIONS_T2, D1.noFailedDLSessionsT3 AS DL_FAILEDSESSIONS_T3, D1.noFailedDLSessionsT4 AS DL_FAILEDSESSIONS_T4, D1.noFailedDLSessionsT5 AS DL_FAILEDSESSIONS_T5, (D1.noDLSessions + D2.noShortDLSessions) AS TOTAL_DL_SAMPLES , D1.noFailedULSessionsT1 AS UL_FAILEDSESSIONS_T1, D1.noFailedULSessionsT2 AS UL_FAILEDSESSIONS_T2, D1.noFailedULSessionsT3 AS UL_FAILEDSESSIONS_T3, D1.noFailedULSessionsT4 AS UL_FAILEDSESSIONS_T4, D1.noFailedULSessionsT5 AS UL_FAILEDSESSIONS_T5, (D1.noULSessions + D2.noShortULSessions) AS TOTAL_UL_SAMPLES FROM ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellFDD AS EUtranCellFDD,SN AS SN, SUM(case when DCVECTOR_INDEX <= 4 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT1 , SUM(case when DCVECTOR_INDEX <= 5 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT2 , SUM(case when DCVECTOR_INDEX <= 6 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT3 , SUM(case when DCVECTOR_INDEX <= 8 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT4, SUM(case when DCVECTOR_INDEX <= 11 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT5 , SUM(pmUeThpDlMbbFiltered2Distr) as noDLSessions, SUM(case when DCVECTOR_INDEX <= 4 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT1, SUM(case when DCVECTOR_INDEX <= 6 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT2, SUM(case when DCVECTOR_INDEX <= 9 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT3, SUM(case when DCVECTOR_INDEX <= 11 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT4, SUM(case when DCVECTOR_INDEX <= 15 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT5, SUM(pmMacUeThpUlMbbLowVolDistr) as noULSessions FROM DC_E_ERBS_EUTRANCELLFDD_V_RAW DA WHERE DA.DATE_ID = @dateID AND DA.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') AND DA.DCVECTOR_INDEX <=26  and ERBS = @erbsName and EUTRANCELLFDD = @cellName and HOUR_ID= @hourID GROUP BY DA.DATE_ID, DA.HOUR_ID, DA.ERBS,DA.EUtranCellFDD,DA.SN ) AS D1, ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellFDD AS EUtranCellFDD,SN AS SN, SUM(pmUeExclThpDlShortDrb) as noShortDLSessions, SUM(pmUeExclThpUlRelativeLowVol+pmUeExclThpUlShortTimeLowVol) as noShortULSessions FROM DC_E_ERBS_EUTRANCELLFDD_RAW DB WHERE DB.DATE_ID =@dateID AND DB.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') GROUP BY DB.DATE_ID, DB.HOUR_ID, DB.ERBS,DB.EUtranCellFDD,DB.SN ) AS D2 WHERE D1.EUtranCellFDD = D2.EUtranCellFDD AND D1.SN =D2.SN AND D1.DATE_ID = D2.DATE_ID AND D1.HOUR_ID = D2.HOUR_ID AND (TOTAL_DL_SAMPLES is not null OR TOTAL_UL_SAMPLES is not null)   UNION  SELECT D1.DATE_ID AS DATE_ID, D1.HOUR_ID AS HOUR_ID, D1.ERBS AS ERBS, D1.EUtranCellTDD AS EUtranCellTDD,D1.SN AS SN, D1.noFailedDLSessionsT1 AS DL_FAILEDSESSIONS_T1, D1.noFailedDLSessionsT2 AS DL_FAILEDSESSIONS_T2, D1.noFailedDLSessionsT3 AS DL_FAILEDSESSIONS_T3, D1.noFailedDLSessionsT4 AS DL_FAILEDSESSIONS_T4, D1.noFailedDLSessionsT5 AS DL_FAILEDSESSIONS_T5, (D1.noDLSessions + D2.noShortDLSessions) AS TOTAL_DL_SAMPLES , D1.noFailedULSessionsT1 AS UL_FAILEDSESSIONS_T1, D1.noFailedULSessionsT2 AS UL_FAILEDSESSIONS_T2, D1.noFailedULSessionsT3 AS UL_FAILEDSESSIONS_T3, D1.noFailedULSessionsT4 AS UL_FAILEDSESSIONS_T4, D1.noFailedULSessionsT5 AS UL_FAILEDSESSIONS_T5, (D1.noULSessions + D2.noShortULSessions) AS TOTAL_UL_SAMPLES FROM ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellTDD AS EUtranCellTDD,SN AS SN, SUM(case when DCVECTOR_INDEX <= 4 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT1 , SUM(case when DCVECTOR_INDEX <= 5 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT2 , SUM(case when DCVECTOR_INDEX <= 6 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT3 , SUM(case when DCVECTOR_INDEX <= 8 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT4, SUM(case when DCVECTOR_INDEX <= 11 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT5 , SUM(pmUeThpDlMbbFiltered2Distr) as noDLSessions, SUM(case when DCVECTOR_INDEX <= 4 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT1, SUM(case when DCVECTOR_INDEX <= 6 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT2, SUM(case when DCVECTOR_INDEX <= 9 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT3, SUM(case when DCVECTOR_INDEX <= 11 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT4, SUM(case when DCVECTOR_INDEX <= 15 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT5, SUM(pmMacUeThpUlMbbLowVolDistr) as noULSessions FROM DC_E_ERBS_EUTRANCELLTDD_V_RAW DA WHERE DA.DATE_ID =@dateID AND DA.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') AND DA.DCVECTOR_INDEX <=26  and  ERBS = @erbsName and EUTRANCELLTDD = @cellName and HOUR_ID =@hourID GROUP BY DA.DATE_ID, DA.HOUR_ID, DA.ERBS,DA.EUtranCellTDD,DA.SN ) AS D1, ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellTDD AS EUtranCellTDD,SN AS SN, SUM(pmUeExclThpDlShortDrb) as noShortDLSessions, SUM(pmUeExclThpUlRelativeLowVol+pmUeExclThpUlShortTimeLowVol) as noShortULSessions FROM DC_E_ERBS_EUTRANCELLTDD_RAW DB WHERE DB.DATE_ID =@dateID AND DB.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') GROUP BY DB.DATE_ID, DB.HOUR_ID, DB.ERBS,DB.EUtranCellTDD,DB.SN ) AS D2 WHERE D1.EUtranCellTDD = D2.EUtranCellTDD AND D1.SN = D2.SN AND D1.DATE_ID = D2.DATE_ID AND D1.HOUR_ID = D2.HOUR_ID AND (TOTAL_DL_SAMPLES is not null OR TOTAL_UL_SAMPLES is not null) ) as Final",
	"TC13": "DECLARE @currentDateTime DATE, @date DATETIME SET @currentDateTime = (getdate()) SET @date = CAST(DATEADD(DAY, -7, @currentDateTime) AS DATE) DECLARE @erbsName VARCHAR(100) = ERBS_NODE DECLARE @cellName VARCHAR(100) = CELL_NAME DECLARE @hourID VARCHAR(3) = HOURID DECLARE @dateID VARCHAR(15) = DATEID select cast(round(avg(DL_FAILEDSESSIONS_T3),0) as numeric(36,2)) as 'AvgFailedUserSession', cast(round((avg(DL_FAILEDSESSIONS_T3)/avg(TOTAL_DL_SAMPLES))*100,0) as numeric(36,2)) as 'FailureRatio' from ( SELECT D1.DATE_ID AS DATE_ID, D1.HOUR_ID AS HOUR_ID, D1.ERBS AS ERBS, D1.EUtranCellFDD AS EUtranCellFDD,D1.SN AS SN, D1.noFailedDLSessionsT1 AS DL_FAILEDSESSIONS_T1, D1.noFailedDLSessionsT2 AS DL_FAILEDSESSIONS_T2, D1.noFailedDLSessionsT3 AS DL_FAILEDSESSIONS_T3, D1.noFailedDLSessionsT4 AS DL_FAILEDSESSIONS_T4, D1.noFailedDLSessionsT5 AS DL_FAILEDSESSIONS_T5, (D1.noDLSessions + D2.noShortDLSessions) AS TOTAL_DL_SAMPLES , D1.noFailedULSessionsT1 AS UL_FAILEDSESSIONS_T1, D1.noFailedULSessionsT2 AS UL_FAILEDSESSIONS_T2, D1.noFailedULSessionsT3 AS UL_FAILEDSESSIONS_T3, D1.noFailedULSessionsT4 AS UL_FAILEDSESSIONS_T4, D1.noFailedULSessionsT5 AS UL_FAILEDSESSIONS_T5, (D1.noULSessions + D2.noShortULSessions) AS TOTAL_UL_SAMPLES FROM ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellFDD AS EUtranCellFDD,SN AS SN, SUM(case when DCVECTOR_INDEX <= 4 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT1 , SUM(case when DCVECTOR_INDEX <= 5 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT2 , SUM(case when DCVECTOR_INDEX <= 6 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT3 , SUM(case when DCVECTOR_INDEX <= 8 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT4, SUM(case when DCVECTOR_INDEX <= 11 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT5 , SUM(pmUeThpDlMbbFiltered2Distr) as noDLSessions, SUM(case when DCVECTOR_INDEX <= 4 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT1, SUM(case when DCVECTOR_INDEX <= 6 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT2, SUM(case when DCVECTOR_INDEX <= 9 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT3, SUM(case when DCVECTOR_INDEX <= 11 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT4, SUM(case when DCVECTOR_INDEX <= 15 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT5, SUM(pmMacUeThpUlMbbLowVolDistr) as noULSessions FROM DC_E_ERBS_EUTRANCELLFDD_V_RAW DA WHERE DA.DATE_ID = @dateID AND DA.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') AND DA.DCVECTOR_INDEX <=26  and ERBS = @erbsName and EUTRANCELLFDD = @cellName and HOUR_ID= @hourID GROUP BY DA.DATE_ID, DA.HOUR_ID, DA.ERBS,DA.EUtranCellFDD,DA.SN ) AS D1, ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellFDD AS EUtranCellFDD,SN AS SN, SUM(pmUeExclThpDlShortDrb) as noShortDLSessions, SUM(pmUeExclThpUlRelativeLowVol+pmUeExclThpUlShortTimeLowVol) as noShortULSessions FROM DC_E_ERBS_EUTRANCELLFDD_RAW DB WHERE DB.DATE_ID =@dateID AND DB.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') GROUP BY DB.DATE_ID, DB.HOUR_ID, DB.ERBS,DB.EUtranCellFDD,DB.SN ) AS D2 WHERE D1.EUtranCellFDD = D2.EUtranCellFDD AND D1.SN =D2.SN AND D1.DATE_ID = D2.DATE_ID AND D1.HOUR_ID = D2.HOUR_ID AND (TOTAL_DL_SAMPLES is not null OR TOTAL_UL_SAMPLES is not null)   UNION  SELECT D1.DATE_ID AS DATE_ID, D1.HOUR_ID AS HOUR_ID, D1.ERBS AS ERBS, D1.EUtranCellTDD AS EUtranCellTDD,D1.SN AS SN, D1.noFailedDLSessionsT1 AS DL_FAILEDSESSIONS_T1, D1.noFailedDLSessionsT2 AS DL_FAILEDSESSIONS_T2, D1.noFailedDLSessionsT3 AS DL_FAILEDSESSIONS_T3, D1.noFailedDLSessionsT4 AS DL_FAILEDSESSIONS_T4, D1.noFailedDLSessionsT5 AS DL_FAILEDSESSIONS_T5, (D1.noDLSessions + D2.noShortDLSessions) AS TOTAL_DL_SAMPLES , D1.noFailedULSessionsT1 AS UL_FAILEDSESSIONS_T1, D1.noFailedULSessionsT2 AS UL_FAILEDSESSIONS_T2, D1.noFailedULSessionsT3 AS UL_FAILEDSESSIONS_T3, D1.noFailedULSessionsT4 AS UL_FAILEDSESSIONS_T4, D1.noFailedULSessionsT5 AS UL_FAILEDSESSIONS_T5, (D1.noULSessions + D2.noShortULSessions) AS TOTAL_UL_SAMPLES FROM ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellTDD AS EUtranCellTDD,SN AS SN, SUM(case when DCVECTOR_INDEX <= 4 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT1 , SUM(case when DCVECTOR_INDEX <= 5 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT2 , SUM(case when DCVECTOR_INDEX <= 6 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT3 , SUM(case when DCVECTOR_INDEX <= 8 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT4, SUM(case when DCVECTOR_INDEX <= 11 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT5 , SUM(pmUeThpDlMbbFiltered2Distr) as noDLSessions, SUM(case when DCVECTOR_INDEX <= 4 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT1, SUM(case when DCVECTOR_INDEX <= 6 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT2, SUM(case when DCVECTOR_INDEX <= 9 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT3, SUM(case when DCVECTOR_INDEX <= 11 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT4, SUM(case when DCVECTOR_INDEX <= 15 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT5, SUM(pmMacUeThpUlMbbLowVolDistr) as noULSessions FROM DC_E_ERBS_EUTRANCELLTDD_V_RAW DA WHERE DA.DATE_ID =@dateID AND DA.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') AND DA.DCVECTOR_INDEX <=26  and  ERBS = @erbsName and EUTRANCELLTDD = @cellName and HOUR_ID =@hourID GROUP BY DA.DATE_ID, DA.HOUR_ID, DA.ERBS,DA.EUtranCellTDD,DA.SN ) AS D1, ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellTDD AS EUtranCellTDD,SN AS SN, SUM(pmUeExclThpDlShortDrb) as noShortDLSessions, SUM(pmUeExclThpUlRelativeLowVol+pmUeExclThpUlShortTimeLowVol) as noShortULSessions FROM DC_E_ERBS_EUTRANCELLTDD_RAW DB WHERE DB.DATE_ID =@dateID AND DB.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') GROUP BY DB.DATE_ID, DB.HOUR_ID, DB.ERBS,DB.EUtranCellTDD,DB.SN ) AS D2 WHERE D1.EUtranCellTDD = D2.EUtranCellTDD AND D1.SN = D2.SN AND D1.DATE_ID = D2.DATE_ID AND D1.HOUR_ID = D2.HOUR_ID AND (TOTAL_DL_SAMPLES is not null OR TOTAL_UL_SAMPLES is not null) ) as Final",
	"TC14": "DECLARE @currentDateTime DATE, @date DATETIME SET @currentDateTime = (getdate()) SET @date = CAST(DATEADD(DAY, -7, @currentDateTime) AS DATE) DECLARE @erbsName VARCHAR(100) = ERBS_NODE DECLARE @cellName VARCHAR(100) = CELL_NAME DECLARE @hourID VARCHAR(3) = HOURID DECLARE @dateID VARCHAR(15) = DATEID select cast(round(avg(DL_FAILEDSESSIONS_T4),0) as numeric(36,2)) as 'AvgFailedUserSession', cast(round((avg(DL_FAILEDSESSIONS_T4)/avg(TOTAL_DL_SAMPLES))*100,0) as numeric(36,2)) as 'FailureRatio' from ( SELECT D1.DATE_ID AS DATE_ID, D1.HOUR_ID AS HOUR_ID, D1.ERBS AS ERBS, D1.EUtranCellFDD AS EUtranCellFDD,D1.SN AS SN, D1.noFailedDLSessionsT1 AS DL_FAILEDSESSIONS_T1, D1.noFailedDLSessionsT2 AS DL_FAILEDSESSIONS_T2, D1.noFailedDLSessionsT3 AS DL_FAILEDSESSIONS_T3, D1.noFailedDLSessionsT4 AS DL_FAILEDSESSIONS_T4, D1.noFailedDLSessionsT5 AS DL_FAILEDSESSIONS_T5, (D1.noDLSessions + D2.noShortDLSessions) AS TOTAL_DL_SAMPLES , D1.noFailedULSessionsT1 AS UL_FAILEDSESSIONS_T1, D1.noFailedULSessionsT2 AS UL_FAILEDSESSIONS_T2, D1.noFailedULSessionsT3 AS UL_FAILEDSESSIONS_T3, D1.noFailedULSessionsT4 AS UL_FAILEDSESSIONS_T4, D1.noFailedULSessionsT5 AS UL_FAILEDSESSIONS_T5, (D1.noULSessions + D2.noShortULSessions) AS TOTAL_UL_SAMPLES FROM ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellFDD AS EUtranCellFDD,SN AS SN, SUM(case when DCVECTOR_INDEX <= 4 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT1 , SUM(case when DCVECTOR_INDEX <= 5 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT2 , SUM(case when DCVECTOR_INDEX <= 6 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT3 , SUM(case when DCVECTOR_INDEX <= 8 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT4, SUM(case when DCVECTOR_INDEX <= 11 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT5 , SUM(pmUeThpDlMbbFiltered2Distr) as noDLSessions, SUM(case when DCVECTOR_INDEX <= 4 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT1, SUM(case when DCVECTOR_INDEX <= 6 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT2, SUM(case when DCVECTOR_INDEX <= 9 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT3, SUM(case when DCVECTOR_INDEX <= 11 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT4, SUM(case when DCVECTOR_INDEX <= 15 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT5, SUM(pmMacUeThpUlMbbLowVolDistr) as noULSessions FROM DC_E_ERBS_EUTRANCELLFDD_V_RAW DA WHERE DA.DATE_ID = @dateID AND DA.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') AND DA.DCVECTOR_INDEX <=26  and ERBS = @erbsName and EUTRANCELLFDD = @cellName and HOUR_ID= @hourID GROUP BY DA.DATE_ID, DA.HOUR_ID, DA.ERBS,DA.EUtranCellFDD,DA.SN ) AS D1, ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellFDD AS EUtranCellFDD,SN AS SN, SUM(pmUeExclThpDlShortDrb) as noShortDLSessions, SUM(pmUeExclThpUlRelativeLowVol+pmUeExclThpUlShortTimeLowVol) as noShortULSessions FROM DC_E_ERBS_EUTRANCELLFDD_RAW DB WHERE DB.DATE_ID =@dateID AND DB.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') GROUP BY DB.DATE_ID, DB.HOUR_ID, DB.ERBS,DB.EUtranCellFDD,DB.SN ) AS D2 WHERE D1.EUtranCellFDD = D2.EUtranCellFDD AND D1.SN =D2.SN AND D1.DATE_ID = D2.DATE_ID AND D1.HOUR_ID = D2.HOUR_ID AND (TOTAL_DL_SAMPLES is not null OR TOTAL_UL_SAMPLES is not null)   UNION  SELECT D1.DATE_ID AS DATE_ID, D1.HOUR_ID AS HOUR_ID, D1.ERBS AS ERBS, D1.EUtranCellTDD AS EUtranCellTDD,D1.SN AS SN, D1.noFailedDLSessionsT1 AS DL_FAILEDSESSIONS_T1, D1.noFailedDLSessionsT2 AS DL_FAILEDSESSIONS_T2, D1.noFailedDLSessionsT3 AS DL_FAILEDSESSIONS_T3, D1.noFailedDLSessionsT4 AS DL_FAILEDSESSIONS_T4, D1.noFailedDLSessionsT5 AS DL_FAILEDSESSIONS_T5, (D1.noDLSessions + D2.noShortDLSessions) AS TOTAL_DL_SAMPLES , D1.noFailedULSessionsT1 AS UL_FAILEDSESSIONS_T1, D1.noFailedULSessionsT2 AS UL_FAILEDSESSIONS_T2, D1.noFailedULSessionsT3 AS UL_FAILEDSESSIONS_T3, D1.noFailedULSessionsT4 AS UL_FAILEDSESSIONS_T4, D1.noFailedULSessionsT5 AS UL_FAILEDSESSIONS_T5, (D1.noULSessions + D2.noShortULSessions) AS TOTAL_UL_SAMPLES FROM ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellTDD AS EUtranCellTDD,SN AS SN, SUM(case when DCVECTOR_INDEX <= 4 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT1 , SUM(case when DCVECTOR_INDEX <= 5 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT2 , SUM(case when DCVECTOR_INDEX <= 6 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT3 , SUM(case when DCVECTOR_INDEX <= 8 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT4, SUM(case when DCVECTOR_INDEX <= 11 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT5 , SUM(pmUeThpDlMbbFiltered2Distr) as noDLSessions, SUM(case when DCVECTOR_INDEX <= 4 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT1, SUM(case when DCVECTOR_INDEX <= 6 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT2, SUM(case when DCVECTOR_INDEX <= 9 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT3, SUM(case when DCVECTOR_INDEX <= 11 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT4, SUM(case when DCVECTOR_INDEX <= 15 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT5, SUM(pmMacUeThpUlMbbLowVolDistr) as noULSessions FROM DC_E_ERBS_EUTRANCELLTDD_V_RAW DA WHERE DA.DATE_ID =@dateID AND DA.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') AND DA.DCVECTOR_INDEX <=26  and  ERBS = @erbsName and EUTRANCELLTDD = @cellName and HOUR_ID =@hourID GROUP BY DA.DATE_ID, DA.HOUR_ID, DA.ERBS,DA.EUtranCellTDD,DA.SN ) AS D1, ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellTDD AS EUtranCellTDD,SN AS SN, SUM(pmUeExclThpDlShortDrb) as noShortDLSessions, SUM(pmUeExclThpUlRelativeLowVol+pmUeExclThpUlShortTimeLowVol) as noShortULSessions FROM DC_E_ERBS_EUTRANCELLTDD_RAW DB WHERE DB.DATE_ID =@dateID AND DB.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') GROUP BY DB.DATE_ID, DB.HOUR_ID, DB.ERBS,DB.EUtranCellTDD,DB.SN ) AS D2 WHERE D1.EUtranCellTDD = D2.EUtranCellTDD AND D1.SN = D2.SN AND D1.DATE_ID = D2.DATE_ID AND D1.HOUR_ID = D2.HOUR_ID AND (TOTAL_DL_SAMPLES is not null OR TOTAL_UL_SAMPLES is not null) ) as Final",
	"TC15": "DECLARE @currentDateTime DATE, @date DATETIME SET @currentDateTime = (getdate()) SET @date = CAST(DATEADD(DAY, -7, @currentDateTime) AS DATE) DECLARE @erbsName VARCHAR(100) = ERBS_NODE DECLARE @cellName VARCHAR(100) = CELL_NAME DECLARE @hourID VARCHAR(3) = HOURID DECLARE @dateID VARCHAR(15) = DATEID select cast(round(avg(DL_FAILEDSESSIONS_T5),0) as numeric(36,2)) as 'AvgFailedUserSession', cast(round((avg(DL_FAILEDSESSIONS_T5)/avg(TOTAL_DL_SAMPLES))*100,0) as numeric(36,2)) as 'FailureRatio' from ( SELECT D1.DATE_ID AS DATE_ID, D1.HOUR_ID AS HOUR_ID, D1.ERBS AS ERBS, D1.EUtranCellFDD AS EUtranCellFDD,D1.SN AS SN, D1.noFailedDLSessionsT1 AS DL_FAILEDSESSIONS_T1, D1.noFailedDLSessionsT2 AS DL_FAILEDSESSIONS_T2, D1.noFailedDLSessionsT3 AS DL_FAILEDSESSIONS_T3, D1.noFailedDLSessionsT4 AS DL_FAILEDSESSIONS_T4, D1.noFailedDLSessionsT5 AS DL_FAILEDSESSIONS_T5, (D1.noDLSessions + D2.noShortDLSessions) AS TOTAL_DL_SAMPLES , D1.noFailedULSessionsT1 AS UL_FAILEDSESSIONS_T1, D1.noFailedULSessionsT2 AS UL_FAILEDSESSIONS_T2, D1.noFailedULSessionsT3 AS UL_FAILEDSESSIONS_T3, D1.noFailedULSessionsT4 AS UL_FAILEDSESSIONS_T4, D1.noFailedULSessionsT5 AS UL_FAILEDSESSIONS_T5, (D1.noULSessions + D2.noShortULSessions) AS TOTAL_UL_SAMPLES FROM ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellFDD AS EUtranCellFDD,SN AS SN, SUM(case when DCVECTOR_INDEX <= 4 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT1 , SUM(case when DCVECTOR_INDEX <= 5 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT2 , SUM(case when DCVECTOR_INDEX <= 6 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT3 , SUM(case when DCVECTOR_INDEX <= 8 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT4, SUM(case when DCVECTOR_INDEX <= 11 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT5 , SUM(pmUeThpDlMbbFiltered2Distr) as noDLSessions, SUM(case when DCVECTOR_INDEX <= 4 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT1, SUM(case when DCVECTOR_INDEX <= 6 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT2, SUM(case when DCVECTOR_INDEX <= 9 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT3, SUM(case when DCVECTOR_INDEX <= 11 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT4, SUM(case when DCVECTOR_INDEX <= 15 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT5, SUM(pmMacUeThpUlMbbLowVolDistr) as noULSessions FROM DC_E_ERBS_EUTRANCELLFDD_V_RAW DA WHERE DA.DATE_ID = @dateID AND DA.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') AND DA.DCVECTOR_INDEX <=26  and ERBS = @erbsName and EUTRANCELLFDD = @cellName and HOUR_ID= @hourID GROUP BY DA.DATE_ID, DA.HOUR_ID, DA.ERBS,DA.EUtranCellFDD,DA.SN ) AS D1, ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellFDD AS EUtranCellFDD,SN AS SN, SUM(pmUeExclThpDlShortDrb) as noShortDLSessions, SUM(pmUeExclThpUlRelativeLowVol+pmUeExclThpUlShortTimeLowVol) as noShortULSessions FROM DC_E_ERBS_EUTRANCELLFDD_RAW DB WHERE DB.DATE_ID =@dateID AND DB.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') GROUP BY DB.DATE_ID, DB.HOUR_ID, DB.ERBS,DB.EUtranCellFDD,DB.SN ) AS D2 WHERE D1.EUtranCellFDD = D2.EUtranCellFDD AND D1.SN =D2.SN AND D1.DATE_ID = D2.DATE_ID AND D1.HOUR_ID = D2.HOUR_ID AND (TOTAL_DL_SAMPLES is not null OR TOTAL_UL_SAMPLES is not null)   UNION  SELECT D1.DATE_ID AS DATE_ID, D1.HOUR_ID AS HOUR_ID, D1.ERBS AS ERBS, D1.EUtranCellTDD AS EUtranCellTDD,D1.SN AS SN, D1.noFailedDLSessionsT1 AS DL_FAILEDSESSIONS_T1, D1.noFailedDLSessionsT2 AS DL_FAILEDSESSIONS_T2, D1.noFailedDLSessionsT3 AS DL_FAILEDSESSIONS_T3, D1.noFailedDLSessionsT4 AS DL_FAILEDSESSIONS_T4, D1.noFailedDLSessionsT5 AS DL_FAILEDSESSIONS_T5, (D1.noDLSessions + D2.noShortDLSessions) AS TOTAL_DL_SAMPLES , D1.noFailedULSessionsT1 AS UL_FAILEDSESSIONS_T1, D1.noFailedULSessionsT2 AS UL_FAILEDSESSIONS_T2, D1.noFailedULSessionsT3 AS UL_FAILEDSESSIONS_T3, D1.noFailedULSessionsT4 AS UL_FAILEDSESSIONS_T4, D1.noFailedULSessionsT5 AS UL_FAILEDSESSIONS_T5, (D1.noULSessions + D2.noShortULSessions) AS TOTAL_UL_SAMPLES FROM ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellTDD AS EUtranCellTDD,SN AS SN, SUM(case when DCVECTOR_INDEX <= 4 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT1 , SUM(case when DCVECTOR_INDEX <= 5 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT2 , SUM(case when DCVECTOR_INDEX <= 6 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT3 , SUM(case when DCVECTOR_INDEX <= 8 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT4, SUM(case when DCVECTOR_INDEX <= 11 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT5 , SUM(pmUeThpDlMbbFiltered2Distr) as noDLSessions, SUM(case when DCVECTOR_INDEX <= 4 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT1, SUM(case when DCVECTOR_INDEX <= 6 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT2, SUM(case when DCVECTOR_INDEX <= 9 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT3, SUM(case when DCVECTOR_INDEX <= 11 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT4, SUM(case when DCVECTOR_INDEX <= 15 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT5, SUM(pmMacUeThpUlMbbLowVolDistr) as noULSessions FROM DC_E_ERBS_EUTRANCELLTDD_V_RAW DA WHERE DA.DATE_ID =@dateID AND DA.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') AND DA.DCVECTOR_INDEX <=26  and  ERBS = @erbsName and EUTRANCELLTDD = @cellName and HOUR_ID =@hourID GROUP BY DA.DATE_ID, DA.HOUR_ID, DA.ERBS,DA.EUtranCellTDD,DA.SN ) AS D1, ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellTDD AS EUtranCellTDD,SN AS SN, SUM(pmUeExclThpDlShortDrb) as noShortDLSessions, SUM(pmUeExclThpUlRelativeLowVol+pmUeExclThpUlShortTimeLowVol) as noShortULSessions FROM DC_E_ERBS_EUTRANCELLTDD_RAW DB WHERE DB.DATE_ID =@dateID AND DB.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') GROUP BY DB.DATE_ID, DB.HOUR_ID, DB.ERBS,DB.EUtranCellTDD,DB.SN ) AS D2 WHERE D1.EUtranCellTDD = D2.EUtranCellTDD AND D1.SN = D2.SN AND D1.DATE_ID = D2.DATE_ID AND D1.HOUR_ID = D2.HOUR_ID AND (TOTAL_DL_SAMPLES is not null OR TOTAL_UL_SAMPLES is not null) ) as Final",
	"TC16": "DECLARE @currentDateTime DATE, @date DATETIME SET @currentDateTime = (getdate()) SET @date = CAST(DATEADD(DAY, -7, @currentDateTime) AS DATE) DECLARE @erbsName VARCHAR(100) = ERBS_NODE DECLARE @cellName VARCHAR(100) = CELL_NAME DECLARE @hourID VARCHAR(3) = HOURID DECLARE @dateID VARCHAR(15) = DATEID select cast(round(avg(UL_FAILEDSESSIONS_T1),0) as numeric(36,2)) as 'AvgFailedUserSession', cast(round((avg(UL_FAILEDSESSIONS_T1)/avg(TOTAL_UL_SAMPLES))*100,0) as numeric(36,2)) as 'FailureRatio' from ( SELECT D1.DATE_ID AS DATE_ID, D1.HOUR_ID AS HOUR_ID, D1.ERBS AS ERBS, D1.EUtranCellFDD AS EUtranCellFDD,D1.SN AS SN, D1.noFailedDLSessionsT1 AS DL_FAILEDSESSIONS_T1, D1.noFailedDLSessionsT2 AS DL_FAILEDSESSIONS_T2, D1.noFailedDLSessionsT3 AS DL_FAILEDSESSIONS_T3, D1.noFailedDLSessionsT4 AS DL_FAILEDSESSIONS_T4, D1.noFailedDLSessionsT5 AS DL_FAILEDSESSIONS_T5, (D1.noDLSessions + D2.noShortDLSessions) AS TOTAL_DL_SAMPLES , D1.noFailedULSessionsT1 AS UL_FAILEDSESSIONS_T1, D1.noFailedULSessionsT2 AS UL_FAILEDSESSIONS_T2, D1.noFailedULSessionsT3 AS UL_FAILEDSESSIONS_T3, D1.noFailedULSessionsT4 AS UL_FAILEDSESSIONS_T4, D1.noFailedULSessionsT5 AS UL_FAILEDSESSIONS_T5, (D1.noULSessions + D2.noShortULSessions) AS TOTAL_UL_SAMPLES FROM ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellFDD AS EUtranCellFDD,SN AS SN, SUM(case when DCVECTOR_INDEX <= 4 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT1 , SUM(case when DCVECTOR_INDEX <= 5 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT2 , SUM(case when DCVECTOR_INDEX <= 6 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT3 , SUM(case when DCVECTOR_INDEX <= 8 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT4, SUM(case when DCVECTOR_INDEX <= 11 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT5 , SUM(pmUeThpDlMbbFiltered2Distr) as noDLSessions, SUM(case when DCVECTOR_INDEX <= 4 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT1, SUM(case when DCVECTOR_INDEX <= 6 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT2, SUM(case when DCVECTOR_INDEX <= 9 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT3, SUM(case when DCVECTOR_INDEX <= 11 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT4, SUM(case when DCVECTOR_INDEX <= 15 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT5, SUM(pmMacUeThpUlMbbLowVolDistr) as noULSessions FROM DC_E_ERBS_EUTRANCELLFDD_V_RAW DA WHERE DA.DATE_ID = @dateID AND DA.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') AND DA.DCVECTOR_INDEX <=26  and ERBS = @erbsName and EUTRANCELLFDD = @cellName and HOUR_ID= @hourID GROUP BY DA.DATE_ID, DA.HOUR_ID, DA.ERBS,DA.EUtranCellFDD,DA.SN ) AS D1, ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellFDD AS EUtranCellFDD,SN AS SN, SUM(pmUeExclThpDlShortDrb) as noShortDLSessions, SUM(pmUeExclThpUlRelativeLowVol+pmUeExclThpUlShortTimeLowVol) as noShortULSessions FROM DC_E_ERBS_EUTRANCELLFDD_RAW DB WHERE DB.DATE_ID =@dateID AND DB.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') GROUP BY DB.DATE_ID, DB.HOUR_ID, DB.ERBS,DB.EUtranCellFDD,DB.SN ) AS D2 WHERE D1.EUtranCellFDD = D2.EUtranCellFDD AND D1.SN =D2.SN AND D1.DATE_ID = D2.DATE_ID AND D1.HOUR_ID = D2.HOUR_ID AND (TOTAL_DL_SAMPLES is not null OR TOTAL_UL_SAMPLES is not null)   UNION  SELECT D1.DATE_ID AS DATE_ID, D1.HOUR_ID AS HOUR_ID, D1.ERBS AS ERBS, D1.EUtranCellTDD AS EUtranCellTDD,D1.SN AS SN, D1.noFailedDLSessionsT1 AS DL_FAILEDSESSIONS_T1, D1.noFailedDLSessionsT2 AS DL_FAILEDSESSIONS_T2, D1.noFailedDLSessionsT3 AS DL_FAILEDSESSIONS_T3, D1.noFailedDLSessionsT4 AS DL_FAILEDSESSIONS_T4, D1.noFailedDLSessionsT5 AS DL_FAILEDSESSIONS_T5, (D1.noDLSessions + D2.noShortDLSessions) AS TOTAL_DL_SAMPLES , D1.noFailedULSessionsT1 AS UL_FAILEDSESSIONS_T1, D1.noFailedULSessionsT2 AS UL_FAILEDSESSIONS_T2, D1.noFailedULSessionsT3 AS UL_FAILEDSESSIONS_T3, D1.noFailedULSessionsT4 AS UL_FAILEDSESSIONS_T4, D1.noFailedULSessionsT5 AS UL_FAILEDSESSIONS_T5, (D1.noULSessions + D2.noShortULSessions) AS TOTAL_UL_SAMPLES FROM ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellTDD AS EUtranCellTDD,SN AS SN, SUM(case when DCVECTOR_INDEX <= 4 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT1 , SUM(case when DCVECTOR_INDEX <= 5 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT2 , SUM(case when DCVECTOR_INDEX <= 6 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT3 , SUM(case when DCVECTOR_INDEX <= 8 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT4, SUM(case when DCVECTOR_INDEX <= 11 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT5 , SUM(pmUeThpDlMbbFiltered2Distr) as noDLSessions, SUM(case when DCVECTOR_INDEX <= 4 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT1, SUM(case when DCVECTOR_INDEX <= 6 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT2, SUM(case when DCVECTOR_INDEX <= 9 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT3, SUM(case when DCVECTOR_INDEX <= 11 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT4, SUM(case when DCVECTOR_INDEX <= 15 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT5, SUM(pmMacUeThpUlMbbLowVolDistr) as noULSessions FROM DC_E_ERBS_EUTRANCELLTDD_V_RAW DA WHERE DA.DATE_ID =@dateID AND DA.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') AND DA.DCVECTOR_INDEX <=26  and  ERBS = @erbsName and EUTRANCELLTDD = @cellName and HOUR_ID =@hourID GROUP BY DA.DATE_ID, DA.HOUR_ID, DA.ERBS,DA.EUtranCellTDD,DA.SN ) AS D1, ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellTDD AS EUtranCellTDD,SN AS SN, SUM(pmUeExclThpDlShortDrb) as noShortDLSessions, SUM(pmUeExclThpUlRelativeLowVol+pmUeExclThpUlShortTimeLowVol) as noShortULSessions FROM DC_E_ERBS_EUTRANCELLTDD_RAW DB WHERE DB.DATE_ID =@dateID AND DB.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') GROUP BY DB.DATE_ID, DB.HOUR_ID, DB.ERBS,DB.EUtranCellTDD,DB.SN ) AS D2 WHERE D1.EUtranCellTDD = D2.EUtranCellTDD AND D1.SN = D2.SN AND D1.DATE_ID = D2.DATE_ID AND D1.HOUR_ID = D2.HOUR_ID AND (TOTAL_DL_SAMPLES is not null OR TOTAL_UL_SAMPLES is not null) ) as Final",
	"TC17": "DECLARE @currentDateTime DATE, @date DATETIME SET @currentDateTime = (getdate()) SET @date = CAST(DATEADD(DAY, -7, @currentDateTime) AS DATE) DECLARE @erbsName VARCHAR(100) = ERBS_NODE DECLARE @cellName VARCHAR(100) = CELL_NAME DECLARE @hourID VARCHAR(3) = HOURID DECLARE @dateID VARCHAR(15) = DATEID select cast(round(avg(UL_FAILEDSESSIONS_T2),0) as numeric(36,2)) as 'AvgFailedUserSession', cast(round((avg(UL_FAILEDSESSIONS_T2)/avg(TOTAL_UL_SAMPLES))*100,0) as numeric(36,2)) as 'FailureRatio' from ( SELECT D1.DATE_ID AS DATE_ID, D1.HOUR_ID AS HOUR_ID, D1.ERBS AS ERBS, D1.EUtranCellFDD AS EUtranCellFDD,D1.SN AS SN, D1.noFailedDLSessionsT1 AS DL_FAILEDSESSIONS_T1, D1.noFailedDLSessionsT2 AS DL_FAILEDSESSIONS_T2, D1.noFailedDLSessionsT3 AS DL_FAILEDSESSIONS_T3, D1.noFailedDLSessionsT4 AS DL_FAILEDSESSIONS_T4, D1.noFailedDLSessionsT5 AS DL_FAILEDSESSIONS_T5, (D1.noDLSessions + D2.noShortDLSessions) AS TOTAL_DL_SAMPLES , D1.noFailedULSessionsT1 AS UL_FAILEDSESSIONS_T1, D1.noFailedULSessionsT2 AS UL_FAILEDSESSIONS_T2, D1.noFailedULSessionsT3 AS UL_FAILEDSESSIONS_T3, D1.noFailedULSessionsT4 AS UL_FAILEDSESSIONS_T4, D1.noFailedULSessionsT5 AS UL_FAILEDSESSIONS_T5, (D1.noULSessions + D2.noShortULSessions) AS TOTAL_UL_SAMPLES FROM ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellFDD AS EUtranCellFDD,SN AS SN, SUM(case when DCVECTOR_INDEX <= 4 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT1 , SUM(case when DCVECTOR_INDEX <= 5 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT2 , SUM(case when DCVECTOR_INDEX <= 6 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT3 , SUM(case when DCVECTOR_INDEX <= 8 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT4, SUM(case when DCVECTOR_INDEX <= 11 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT5 , SUM(pmUeThpDlMbbFiltered2Distr) as noDLSessions, SUM(case when DCVECTOR_INDEX <= 4 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT1, SUM(case when DCVECTOR_INDEX <= 6 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT2, SUM(case when DCVECTOR_INDEX <= 9 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT3, SUM(case when DCVECTOR_INDEX <= 11 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT4, SUM(case when DCVECTOR_INDEX <= 15 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT5, SUM(pmMacUeThpUlMbbLowVolDistr) as noULSessions FROM DC_E_ERBS_EUTRANCELLFDD_V_RAW DA WHERE DA.DATE_ID = @dateID AND DA.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') AND DA.DCVECTOR_INDEX <=26  and ERBS = @erbsName and EUTRANCELLFDD = @cellName and HOUR_ID= @hourID GROUP BY DA.DATE_ID, DA.HOUR_ID, DA.ERBS,DA.EUtranCellFDD,DA.SN ) AS D1, ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellFDD AS EUtranCellFDD,SN AS SN, SUM(pmUeExclThpDlShortDrb) as noShortDLSessions, SUM(pmUeExclThpUlRelativeLowVol+pmUeExclThpUlShortTimeLowVol) as noShortULSessions FROM DC_E_ERBS_EUTRANCELLFDD_RAW DB WHERE DB.DATE_ID =@dateID AND DB.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') GROUP BY DB.DATE_ID, DB.HOUR_ID, DB.ERBS,DB.EUtranCellFDD,DB.SN ) AS D2 WHERE D1.EUtranCellFDD = D2.EUtranCellFDD AND D1.SN =D2.SN AND D1.DATE_ID = D2.DATE_ID AND D1.HOUR_ID = D2.HOUR_ID AND (TOTAL_DL_SAMPLES is not null OR TOTAL_UL_SAMPLES is not null)   UNION  SELECT D1.DATE_ID AS DATE_ID, D1.HOUR_ID AS HOUR_ID, D1.ERBS AS ERBS, D1.EUtranCellTDD AS EUtranCellTDD,D1.SN AS SN, D1.noFailedDLSessionsT1 AS DL_FAILEDSESSIONS_T1, D1.noFailedDLSessionsT2 AS DL_FAILEDSESSIONS_T2, D1.noFailedDLSessionsT3 AS DL_FAILEDSESSIONS_T3, D1.noFailedDLSessionsT4 AS DL_FAILEDSESSIONS_T4, D1.noFailedDLSessionsT5 AS DL_FAILEDSESSIONS_T5, (D1.noDLSessions + D2.noShortDLSessions) AS TOTAL_DL_SAMPLES , D1.noFailedULSessionsT1 AS UL_FAILEDSESSIONS_T1, D1.noFailedULSessionsT2 AS UL_FAILEDSESSIONS_T2, D1.noFailedULSessionsT3 AS UL_FAILEDSESSIONS_T3, D1.noFailedULSessionsT4 AS UL_FAILEDSESSIONS_T4, D1.noFailedULSessionsT5 AS UL_FAILEDSESSIONS_T5, (D1.noULSessions + D2.noShortULSessions) AS TOTAL_UL_SAMPLES FROM ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellTDD AS EUtranCellTDD,SN AS SN, SUM(case when DCVECTOR_INDEX <= 4 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT1 , SUM(case when DCVECTOR_INDEX <= 5 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT2 , SUM(case when DCVECTOR_INDEX <= 6 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT3 , SUM(case when DCVECTOR_INDEX <= 8 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT4, SUM(case when DCVECTOR_INDEX <= 11 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT5 , SUM(pmUeThpDlMbbFiltered2Distr) as noDLSessions, SUM(case when DCVECTOR_INDEX <= 4 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT1, SUM(case when DCVECTOR_INDEX <= 6 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT2, SUM(case when DCVECTOR_INDEX <= 9 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT3, SUM(case when DCVECTOR_INDEX <= 11 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT4, SUM(case when DCVECTOR_INDEX <= 15 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT5, SUM(pmMacUeThpUlMbbLowVolDistr) as noULSessions FROM DC_E_ERBS_EUTRANCELLTDD_V_RAW DA WHERE DA.DATE_ID =@dateID AND DA.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') AND DA.DCVECTOR_INDEX <=26  and  ERBS = @erbsName and EUTRANCELLTDD = @cellName and HOUR_ID =@hourID GROUP BY DA.DATE_ID, DA.HOUR_ID, DA.ERBS,DA.EUtranCellTDD,DA.SN ) AS D1, ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellTDD AS EUtranCellTDD,SN AS SN, SUM(pmUeExclThpDlShortDrb) as noShortDLSessions, SUM(pmUeExclThpUlRelativeLowVol+pmUeExclThpUlShortTimeLowVol) as noShortULSessions FROM DC_E_ERBS_EUTRANCELLTDD_RAW DB WHERE DB.DATE_ID =@dateID AND DB.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') GROUP BY DB.DATE_ID, DB.HOUR_ID, DB.ERBS,DB.EUtranCellTDD,DB.SN ) AS D2 WHERE D1.EUtranCellTDD = D2.EUtranCellTDD AND D1.SN = D2.SN AND D1.DATE_ID = D2.DATE_ID AND D1.HOUR_ID = D2.HOUR_ID AND (TOTAL_DL_SAMPLES is not null OR TOTAL_UL_SAMPLES is not null) ) as Final",
	"TC18": "DECLARE @currentDateTime DATE, @date DATETIME SET @currentDateTime = (getdate()) SET @date = CAST(DATEADD(DAY, -7, @currentDateTime) AS DATE) DECLARE @erbsName VARCHAR(100) = ERBS_NODE DECLARE @cellName VARCHAR(100) = CELL_NAME DECLARE @hourID VARCHAR(3) = HOURID DECLARE @dateID VARCHAR(15) = DATEID select cast(round(avg(UL_FAILEDSESSIONS_T3),0) as numeric(36,2)) as 'AvgFailedUserSession', cast(round((avg(UL_FAILEDSESSIONS_T3)/avg(TOTAL_UL_SAMPLES))*100,0) as numeric(36,2)) as 'FailureRatio' from ( SELECT D1.DATE_ID AS DATE_ID, D1.HOUR_ID AS HOUR_ID, D1.ERBS AS ERBS, D1.EUtranCellFDD AS EUtranCellFDD,D1.SN AS SN, D1.noFailedDLSessionsT1 AS DL_FAILEDSESSIONS_T1, D1.noFailedDLSessionsT2 AS DL_FAILEDSESSIONS_T2, D1.noFailedDLSessionsT3 AS DL_FAILEDSESSIONS_T3, D1.noFailedDLSessionsT4 AS DL_FAILEDSESSIONS_T4, D1.noFailedDLSessionsT5 AS DL_FAILEDSESSIONS_T5, (D1.noDLSessions + D2.noShortDLSessions) AS TOTAL_DL_SAMPLES , D1.noFailedULSessionsT1 AS UL_FAILEDSESSIONS_T1, D1.noFailedULSessionsT2 AS UL_FAILEDSESSIONS_T2, D1.noFailedULSessionsT3 AS UL_FAILEDSESSIONS_T3, D1.noFailedULSessionsT4 AS UL_FAILEDSESSIONS_T4, D1.noFailedULSessionsT5 AS UL_FAILEDSESSIONS_T5, (D1.noULSessions + D2.noShortULSessions) AS TOTAL_UL_SAMPLES FROM ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellFDD AS EUtranCellFDD,SN AS SN, SUM(case when DCVECTOR_INDEX <= 4 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT1 , SUM(case when DCVECTOR_INDEX <= 5 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT2 , SUM(case when DCVECTOR_INDEX <= 6 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT3 , SUM(case when DCVECTOR_INDEX <= 8 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT4, SUM(case when DCVECTOR_INDEX <= 11 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT5 , SUM(pmUeThpDlMbbFiltered2Distr) as noDLSessions, SUM(case when DCVECTOR_INDEX <= 4 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT1, SUM(case when DCVECTOR_INDEX <= 6 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT2, SUM(case when DCVECTOR_INDEX <= 9 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT3, SUM(case when DCVECTOR_INDEX <= 11 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT4, SUM(case when DCVECTOR_INDEX <= 15 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT5, SUM(pmMacUeThpUlMbbLowVolDistr) as noULSessions FROM DC_E_ERBS_EUTRANCELLFDD_V_RAW DA WHERE DA.DATE_ID = @dateID AND DA.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') AND DA.DCVECTOR_INDEX <=26  and ERBS = @erbsName and EUTRANCELLFDD = @cellName and HOUR_ID= @hourID GROUP BY DA.DATE_ID, DA.HOUR_ID, DA.ERBS,DA.EUtranCellFDD,DA.SN ) AS D1, ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellFDD AS EUtranCellFDD,SN AS SN, SUM(pmUeExclThpDlShortDrb) as noShortDLSessions, SUM(pmUeExclThpUlRelativeLowVol+pmUeExclThpUlShortTimeLowVol) as noShortULSessions FROM DC_E_ERBS_EUTRANCELLFDD_RAW DB WHERE DB.DATE_ID =@dateID AND DB.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') GROUP BY DB.DATE_ID, DB.HOUR_ID, DB.ERBS,DB.EUtranCellFDD,DB.SN ) AS D2 WHERE D1.EUtranCellFDD = D2.EUtranCellFDD AND D1.SN =D2.SN AND D1.DATE_ID = D2.DATE_ID AND D1.HOUR_ID = D2.HOUR_ID AND (TOTAL_DL_SAMPLES is not null OR TOTAL_UL_SAMPLES is not null)   UNION  SELECT D1.DATE_ID AS DATE_ID, D1.HOUR_ID AS HOUR_ID, D1.ERBS AS ERBS, D1.EUtranCellTDD AS EUtranCellTDD,D1.SN AS SN, D1.noFailedDLSessionsT1 AS DL_FAILEDSESSIONS_T1, D1.noFailedDLSessionsT2 AS DL_FAILEDSESSIONS_T2, D1.noFailedDLSessionsT3 AS DL_FAILEDSESSIONS_T3, D1.noFailedDLSessionsT4 AS DL_FAILEDSESSIONS_T4, D1.noFailedDLSessionsT5 AS DL_FAILEDSESSIONS_T5, (D1.noDLSessions + D2.noShortDLSessions) AS TOTAL_DL_SAMPLES , D1.noFailedULSessionsT1 AS UL_FAILEDSESSIONS_T1, D1.noFailedULSessionsT2 AS UL_FAILEDSESSIONS_T2, D1.noFailedULSessionsT3 AS UL_FAILEDSESSIONS_T3, D1.noFailedULSessionsT4 AS UL_FAILEDSESSIONS_T4, D1.noFailedULSessionsT5 AS UL_FAILEDSESSIONS_T5, (D1.noULSessions + D2.noShortULSessions) AS TOTAL_UL_SAMPLES FROM ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellTDD AS EUtranCellTDD,SN AS SN, SUM(case when DCVECTOR_INDEX <= 4 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT1 , SUM(case when DCVECTOR_INDEX <= 5 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT2 , SUM(case when DCVECTOR_INDEX <= 6 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT3 , SUM(case when DCVECTOR_INDEX <= 8 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT4, SUM(case when DCVECTOR_INDEX <= 11 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT5 , SUM(pmUeThpDlMbbFiltered2Distr) as noDLSessions, SUM(case when DCVECTOR_INDEX <= 4 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT1, SUM(case when DCVECTOR_INDEX <= 6 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT2, SUM(case when DCVECTOR_INDEX <= 9 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT3, SUM(case when DCVECTOR_INDEX <= 11 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT4, SUM(case when DCVECTOR_INDEX <= 15 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT5, SUM(pmMacUeThpUlMbbLowVolDistr) as noULSessions FROM DC_E_ERBS_EUTRANCELLTDD_V_RAW DA WHERE DA.DATE_ID =@dateID AND DA.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') AND DA.DCVECTOR_INDEX <=26  and  ERBS = @erbsName and EUTRANCELLTDD = @cellName and HOUR_ID =@hourID GROUP BY DA.DATE_ID, DA.HOUR_ID, DA.ERBS,DA.EUtranCellTDD,DA.SN ) AS D1, ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellTDD AS EUtranCellTDD,SN AS SN, SUM(pmUeExclThpDlShortDrb) as noShortDLSessions, SUM(pmUeExclThpUlRelativeLowVol+pmUeExclThpUlShortTimeLowVol) as noShortULSessions FROM DC_E_ERBS_EUTRANCELLTDD_RAW DB WHERE DB.DATE_ID =@dateID AND DB.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') GROUP BY DB.DATE_ID, DB.HOUR_ID, DB.ERBS,DB.EUtranCellTDD,DB.SN ) AS D2 WHERE D1.EUtranCellTDD = D2.EUtranCellTDD AND D1.SN = D2.SN AND D1.DATE_ID = D2.DATE_ID AND D1.HOUR_ID = D2.HOUR_ID AND (TOTAL_DL_SAMPLES is not null OR TOTAL_UL_SAMPLES is not null) ) as Final",
	"TC19": "DECLARE @currentDateTime DATE, @date DATETIME SET @currentDateTime = (getdate()) SET @date = CAST(DATEADD(DAY, -7, @currentDateTime) AS DATE) DECLARE @erbsName VARCHAR(100) = ERBS_NODE DECLARE @cellName VARCHAR(100) = CELL_NAME DECLARE @hourID VARCHAR(3) = HOURID DECLARE @dateID VARCHAR(15) = DATEID select cast(round(avg(UL_FAILEDSESSIONS_T4),0) as numeric(36,2)) as 'AvgFailedUserSession', cast(round((avg(UL_FAILEDSESSIONS_T4)/avg(TOTAL_UL_SAMPLES))*100,0) as numeric(36,2)) as 'FailureRatio' from ( SELECT D1.DATE_ID AS DATE_ID, D1.HOUR_ID AS HOUR_ID, D1.ERBS AS ERBS, D1.EUtranCellFDD AS EUtranCellFDD,D1.SN AS SN, D1.noFailedDLSessionsT1 AS DL_FAILEDSESSIONS_T1, D1.noFailedDLSessionsT2 AS DL_FAILEDSESSIONS_T2, D1.noFailedDLSessionsT3 AS DL_FAILEDSESSIONS_T3, D1.noFailedDLSessionsT4 AS DL_FAILEDSESSIONS_T4, D1.noFailedDLSessionsT5 AS DL_FAILEDSESSIONS_T5, (D1.noDLSessions + D2.noShortDLSessions) AS TOTAL_DL_SAMPLES , D1.noFailedULSessionsT1 AS UL_FAILEDSESSIONS_T1, D1.noFailedULSessionsT2 AS UL_FAILEDSESSIONS_T2, D1.noFailedULSessionsT3 AS UL_FAILEDSESSIONS_T3, D1.noFailedULSessionsT4 AS UL_FAILEDSESSIONS_T4, D1.noFailedULSessionsT5 AS UL_FAILEDSESSIONS_T5, (D1.noULSessions + D2.noShortULSessions) AS TOTAL_UL_SAMPLES FROM ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellFDD AS EUtranCellFDD,SN AS SN, SUM(case when DCVECTOR_INDEX <= 4 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT1 , SUM(case when DCVECTOR_INDEX <= 5 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT2 , SUM(case when DCVECTOR_INDEX <= 6 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT3 , SUM(case when DCVECTOR_INDEX <= 8 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT4, SUM(case when DCVECTOR_INDEX <= 11 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT5 , SUM(pmUeThpDlMbbFiltered2Distr) as noDLSessions, SUM(case when DCVECTOR_INDEX <= 4 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT1, SUM(case when DCVECTOR_INDEX <= 6 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT2, SUM(case when DCVECTOR_INDEX <= 9 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT3, SUM(case when DCVECTOR_INDEX <= 11 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT4, SUM(case when DCVECTOR_INDEX <= 15 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT5, SUM(pmMacUeThpUlMbbLowVolDistr) as noULSessions FROM DC_E_ERBS_EUTRANCELLFDD_V_RAW DA WHERE DA.DATE_ID = @dateID AND DA.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') AND DA.DCVECTOR_INDEX <=26  and ERBS = @erbsName and EUTRANCELLFDD = @cellName and HOUR_ID= @hourID GROUP BY DA.DATE_ID, DA.HOUR_ID, DA.ERBS,DA.EUtranCellFDD,DA.SN ) AS D1, ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellFDD AS EUtranCellFDD,SN AS SN, SUM(pmUeExclThpDlShortDrb) as noShortDLSessions, SUM(pmUeExclThpUlRelativeLowVol+pmUeExclThpUlShortTimeLowVol) as noShortULSessions FROM DC_E_ERBS_EUTRANCELLFDD_RAW DB WHERE DB.DATE_ID =@dateID AND DB.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') GROUP BY DB.DATE_ID, DB.HOUR_ID, DB.ERBS,DB.EUtranCellFDD,DB.SN ) AS D2 WHERE D1.EUtranCellFDD = D2.EUtranCellFDD AND D1.SN =D2.SN AND D1.DATE_ID = D2.DATE_ID AND D1.HOUR_ID = D2.HOUR_ID AND (TOTAL_DL_SAMPLES is not null OR TOTAL_UL_SAMPLES is not null)   UNION  SELECT D1.DATE_ID AS DATE_ID, D1.HOUR_ID AS HOUR_ID, D1.ERBS AS ERBS, D1.EUtranCellTDD AS EUtranCellTDD,D1.SN AS SN, D1.noFailedDLSessionsT1 AS DL_FAILEDSESSIONS_T1, D1.noFailedDLSessionsT2 AS DL_FAILEDSESSIONS_T2, D1.noFailedDLSessionsT3 AS DL_FAILEDSESSIONS_T3, D1.noFailedDLSessionsT4 AS DL_FAILEDSESSIONS_T4, D1.noFailedDLSessionsT5 AS DL_FAILEDSESSIONS_T5, (D1.noDLSessions + D2.noShortDLSessions) AS TOTAL_DL_SAMPLES , D1.noFailedULSessionsT1 AS UL_FAILEDSESSIONS_T1, D1.noFailedULSessionsT2 AS UL_FAILEDSESSIONS_T2, D1.noFailedULSessionsT3 AS UL_FAILEDSESSIONS_T3, D1.noFailedULSessionsT4 AS UL_FAILEDSESSIONS_T4, D1.noFailedULSessionsT5 AS UL_FAILEDSESSIONS_T5, (D1.noULSessions + D2.noShortULSessions) AS TOTAL_UL_SAMPLES FROM ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellTDD AS EUtranCellTDD,SN AS SN, SUM(case when DCVECTOR_INDEX <= 4 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT1 , SUM(case when DCVECTOR_INDEX <= 5 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT2 , SUM(case when DCVECTOR_INDEX <= 6 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT3 , SUM(case when DCVECTOR_INDEX <= 8 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT4, SUM(case when DCVECTOR_INDEX <= 11 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT5 , SUM(pmUeThpDlMbbFiltered2Distr) as noDLSessions, SUM(case when DCVECTOR_INDEX <= 4 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT1, SUM(case when DCVECTOR_INDEX <= 6 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT2, SUM(case when DCVECTOR_INDEX <= 9 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT3, SUM(case when DCVECTOR_INDEX <= 11 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT4, SUM(case when DCVECTOR_INDEX <= 15 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT5, SUM(pmMacUeThpUlMbbLowVolDistr) as noULSessions FROM DC_E_ERBS_EUTRANCELLTDD_V_RAW DA WHERE DA.DATE_ID =@dateID AND DA.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') AND DA.DCVECTOR_INDEX <=26  and  ERBS = @erbsName and EUTRANCELLTDD = @cellName and HOUR_ID =@hourID GROUP BY DA.DATE_ID, DA.HOUR_ID, DA.ERBS,DA.EUtranCellTDD,DA.SN ) AS D1, ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellTDD AS EUtranCellTDD,SN AS SN, SUM(pmUeExclThpDlShortDrb) as noShortDLSessions, SUM(pmUeExclThpUlRelativeLowVol+pmUeExclThpUlShortTimeLowVol) as noShortULSessions FROM DC_E_ERBS_EUTRANCELLTDD_RAW DB WHERE DB.DATE_ID =@dateID AND DB.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') GROUP BY DB.DATE_ID, DB.HOUR_ID, DB.ERBS,DB.EUtranCellTDD,DB.SN ) AS D2 WHERE D1.EUtranCellTDD = D2.EUtranCellTDD AND D1.SN = D2.SN AND D1.DATE_ID = D2.DATE_ID AND D1.HOUR_ID = D2.HOUR_ID AND (TOTAL_DL_SAMPLES is not null OR TOTAL_UL_SAMPLES is not null) ) as Final",
	"TC20": "DECLARE @currentDateTime DATE, @date DATETIME SET @currentDateTime = (getdate()) SET @date = CAST(DATEADD(DAY, -7, @currentDateTime) AS DATE) DECLARE @erbsName VARCHAR(100) = ERBS_NODE DECLARE @cellName VARCHAR(100) = CELL_NAME DECLARE @hourID VARCHAR(3) = HOURID DECLARE @dateID VARCHAR(15) = DATEID select cast(round(avg(UL_FAILEDSESSIONS_T5),0) as numeric(36,2)) as 'AvgFailedUserSession', cast(round((avg(UL_FAILEDSESSIONS_T5)/avg(TOTAL_UL_SAMPLES))*100,0) as numeric(36,2)) as 'FailureRatio' from ( SELECT D1.DATE_ID AS DATE_ID, D1.HOUR_ID AS HOUR_ID, D1.ERBS AS ERBS, D1.EUtranCellFDD AS EUtranCellFDD,D1.SN AS SN, D1.noFailedDLSessionsT1 AS DL_FAILEDSESSIONS_T1, D1.noFailedDLSessionsT2 AS DL_FAILEDSESSIONS_T2, D1.noFailedDLSessionsT3 AS DL_FAILEDSESSIONS_T3, D1.noFailedDLSessionsT4 AS DL_FAILEDSESSIONS_T4, D1.noFailedDLSessionsT5 AS DL_FAILEDSESSIONS_T5, (D1.noDLSessions + D2.noShortDLSessions) AS TOTAL_DL_SAMPLES , D1.noFailedULSessionsT1 AS UL_FAILEDSESSIONS_T1, D1.noFailedULSessionsT2 AS UL_FAILEDSESSIONS_T2, D1.noFailedULSessionsT3 AS UL_FAILEDSESSIONS_T3, D1.noFailedULSessionsT4 AS UL_FAILEDSESSIONS_T4, D1.noFailedULSessionsT5 AS UL_FAILEDSESSIONS_T5, (D1.noULSessions + D2.noShortULSessions) AS TOTAL_UL_SAMPLES FROM ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellFDD AS EUtranCellFDD,SN AS SN, SUM(case when DCVECTOR_INDEX <= 4 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT1 , SUM(case when DCVECTOR_INDEX <= 5 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT2 , SUM(case when DCVECTOR_INDEX <= 6 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT3 , SUM(case when DCVECTOR_INDEX <= 8 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT4, SUM(case when DCVECTOR_INDEX <= 11 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT5 , SUM(pmUeThpDlMbbFiltered2Distr) as noDLSessions, SUM(case when DCVECTOR_INDEX <= 4 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT1, SUM(case when DCVECTOR_INDEX <= 6 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT2, SUM(case when DCVECTOR_INDEX <= 9 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT3, SUM(case when DCVECTOR_INDEX <= 11 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT4, SUM(case when DCVECTOR_INDEX <= 15 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT5, SUM(pmMacUeThpUlMbbLowVolDistr) as noULSessions FROM DC_E_ERBS_EUTRANCELLFDD_V_RAW DA WHERE DA.DATE_ID = @dateID AND DA.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') AND DA.DCVECTOR_INDEX <=26  and ERBS = @erbsName and EUTRANCELLFDD = @cellName and HOUR_ID= @hourID GROUP BY DA.DATE_ID, DA.HOUR_ID, DA.ERBS,DA.EUtranCellFDD,DA.SN ) AS D1, ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellFDD AS EUtranCellFDD,SN AS SN, SUM(pmUeExclThpDlShortDrb) as noShortDLSessions, SUM(pmUeExclThpUlRelativeLowVol+pmUeExclThpUlShortTimeLowVol) as noShortULSessions FROM DC_E_ERBS_EUTRANCELLFDD_RAW DB WHERE DB.DATE_ID =@dateID AND DB.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') GROUP BY DB.DATE_ID, DB.HOUR_ID, DB.ERBS,DB.EUtranCellFDD,DB.SN ) AS D2 WHERE D1.EUtranCellFDD = D2.EUtranCellFDD AND D1.SN =D2.SN AND D1.DATE_ID = D2.DATE_ID AND D1.HOUR_ID = D2.HOUR_ID AND (TOTAL_DL_SAMPLES is not null OR TOTAL_UL_SAMPLES is not null)   UNION  SELECT D1.DATE_ID AS DATE_ID, D1.HOUR_ID AS HOUR_ID, D1.ERBS AS ERBS, D1.EUtranCellTDD AS EUtranCellTDD,D1.SN AS SN, D1.noFailedDLSessionsT1 AS DL_FAILEDSESSIONS_T1, D1.noFailedDLSessionsT2 AS DL_FAILEDSESSIONS_T2, D1.noFailedDLSessionsT3 AS DL_FAILEDSESSIONS_T3, D1.noFailedDLSessionsT4 AS DL_FAILEDSESSIONS_T4, D1.noFailedDLSessionsT5 AS DL_FAILEDSESSIONS_T5, (D1.noDLSessions + D2.noShortDLSessions) AS TOTAL_DL_SAMPLES , D1.noFailedULSessionsT1 AS UL_FAILEDSESSIONS_T1, D1.noFailedULSessionsT2 AS UL_FAILEDSESSIONS_T2, D1.noFailedULSessionsT3 AS UL_FAILEDSESSIONS_T3, D1.noFailedULSessionsT4 AS UL_FAILEDSESSIONS_T4, D1.noFailedULSessionsT5 AS UL_FAILEDSESSIONS_T5, (D1.noULSessions + D2.noShortULSessions) AS TOTAL_UL_SAMPLES FROM ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellTDD AS EUtranCellTDD,SN AS SN, SUM(case when DCVECTOR_INDEX <= 4 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT1 , SUM(case when DCVECTOR_INDEX <= 5 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT2 , SUM(case when DCVECTOR_INDEX <= 6 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT3 , SUM(case when DCVECTOR_INDEX <= 8 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT4, SUM(case when DCVECTOR_INDEX <= 11 then pmUeThpDlMbbFiltered2Distr else 0 end) as noFailedDLSessionsT5 , SUM(pmUeThpDlMbbFiltered2Distr) as noDLSessions, SUM(case when DCVECTOR_INDEX <= 4 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT1, SUM(case when DCVECTOR_INDEX <= 6 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT2, SUM(case when DCVECTOR_INDEX <= 9 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT3, SUM(case when DCVECTOR_INDEX <= 11 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT4, SUM(case when DCVECTOR_INDEX <= 15 then pmMacUeThpUlMbbLowVolDistr else 0 end) as noFailedULSessionsT5, SUM(pmMacUeThpUlMbbLowVolDistr) as noULSessions FROM DC_E_ERBS_EUTRANCELLTDD_V_RAW DA WHERE DA.DATE_ID =@dateID AND DA.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') AND DA.DCVECTOR_INDEX <=26  and  ERBS = @erbsName and EUTRANCELLTDD = @cellName and HOUR_ID =@hourID GROUP BY DA.DATE_ID, DA.HOUR_ID, DA.ERBS,DA.EUtranCellTDD,DA.SN ) AS D1, ( SELECT DATE_ID AS DATE_ID, HOUR_ID AS HOUR_ID, ERBS AS ERBS, EUtranCellTDD AS EUtranCellTDD,SN AS SN, SUM(pmUeExclThpDlShortDrb) as noShortDLSessions, SUM(pmUeExclThpUlRelativeLowVol+pmUeExclThpUlShortTimeLowVol) as noShortULSessions FROM DC_E_ERBS_EUTRANCELLTDD_RAW DB WHERE DB.DATE_ID =@dateID AND DB.ROWSTATUS NOT IN ('DUPLICATE','SUSPECTED') GROUP BY DB.DATE_ID, DB.HOUR_ID, DB.ERBS,DB.EUtranCellTDD,DB.SN ) AS D2 WHERE D1.EUtranCellTDD = D2.EUtranCellTDD AND D1.SN = D2.SN AND D1.DATE_ID = D2.DATE_ID AND D1.HOUR_ID = D2.HOUR_ID AND (TOTAL_DL_SAMPLES is not null OR TOTAL_UL_SAMPLES is not null) ) as Final"		            
}